var es=Object.defineProperty;var ts=(s,e,t)=>e in s?es(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var G=(s,e,t)=>(ts(s,typeof e!="symbol"?e+"":e,t),t);import{n as ye,C as J,G as L,E as ss,o as ls,F as is,b as p,k as O,f as g,g as T,l as W,d as b,h as d,J as je,j as E,i as K,x as _,m as rt,s as I,c as N,e as at,Q as re,D as ns,P as Gt,R as Ht,p as as,L as Ye,S as os,U as rs,K as us,O as Ze}from"../chunks/scheduler.05062a41.js";import{S as ke,i as Ee,a as H,g as $e,t as B,c as et,b as Le,d as He,m as Pe,e as ze,f as _s}from"../chunks/index.0b9e8d1c.js";import{w as we}from"../chunks/index.ef582b24.js";import{g as cs,e as Ae,u as yt,o as Jt,d as ds}from"../chunks/each.0793ff45.js";const{window:fs}=cs;function hs(s){let e,t;return{c:J,l:J,m(l,n){e||(t=L(fs,"message",s[0]),e=!0)},p:J,i:J,o:J,d(l){e=!1,t()}}}const ms=6e3;function ps(s,e,t){let{host:l=typeof window<"u"&&window.parent!==window?window.parent:null}=e,{target_origin:n="*"}=e,{connect_on_mount:i=!0}=e;const o=ss(),a=m=>{l&&(l instanceof ServiceWorker||l instanceof MessagePort?l.postMessage(m):l.postMessage(m,n))};ls(async()=>{i&&await D()}),is(()=>{v&&clearTimeout(v)});let r="initial",u,c,h,v;const D=async()=>l?u&&c===l?u:(c=l,u=new Promise(m=>{h=m,r="pending",a({type:"felt.connect"}),v=setTimeout(()=>{r="failure",u=void 0,v=void 0,h(!1),h=void 0},ms)})):!1,F=m=>{if(m.source!==l)return;const C=m.data;if(C){if(C.type==="felt.connected"){if(r!=="pending")return;r="success",clearTimeout(v),v=void 0,h(!0),h=void 0}C.type&&r==="success"&&o("message",C)}};return s.$$set=m=>{"host"in m&&t(1,l=m.host),"target_origin"in m&&t(2,n=m.target_origin),"connect_on_mount"in m&&t(3,i=m.connect_on_mount)},[F,l,n,i,a,D]}class gs extends ke{constructor(e){super(),Ee(this,e,ps,hs,ye,{host:1,target_origin:2,connect_on_mount:3,post_message:4,connect:5})}get post_message(){return this.$$.ctx[4]}get connect(){return this.$$.ctx[5]}}class vs extends Error{constructor(e,t=`Unreachable case: ${e}`){super(t)}}const Kt=(s,e,t=Math.random)=>t()*(e-s)+s,kt=(s,e,t=Math.random)=>Math.floor(t()*(e-s+1))+s,ot=(s,e=Math.random)=>s[kt(0,s.length-1,e)];function bs(s){let e,t,l=s[0].char+"",n;return{c(){e=p("div"),t=p("div"),n=O(l),this.h()},l(i){e=g(i,"DIV",{class:!0,style:!0});var o=T(e);t=g(o,"DIV",{class:!0});var a=T(t);n=W(a,l),a.forEach(b),o.forEach(b),this.h()},h(){d(t,"class","svelte-10gyibm"),je(t,"dead",s[0].dead),d(e,"class","item svelte-10gyibm"),E(e,"transform","translate3d("+s[3]+"px, "+s[2]+"px, 0px) scale3d("+s[5]+", "+s[5]+", "+s[5]+")"),E(e,"--grayscale",s[4]),E(e,"opacity",1-s[1])},m(i,o){K(i,e,o),_(e,t),_(t,n)},p(i,[o]){o&1&&l!==(l=i[0].char+"")&&rt(n,l),o&1&&je(t,"dead",i[0].dead),o&44&&E(e,"transform","translate3d("+i[3]+"px, "+i[2]+"px, 0px) scale3d("+i[5]+", "+i[5]+", "+i[5]+")"),o&16&&E(e,"--grayscale",i[4]),o&2&&E(e,"opacity",1-i[1])},i:J,o:J,d(i){i&&b(e)}}}function ws(s,e,t){let l,n,i,o,a,{item:r}=e,{tile_width:u}=e,{tile_height:c}=e;return s.$$set=h=>{"item"in h&&t(0,r=h.item),"tile_width"in h&&t(6,u=h.tile_width),"tile_height"in h&&t(7,c=h.tile_height)},s.$$.update=()=>{s.$$.dirty&1&&t(1,l=r.dead?(r.age-r.dead_age)/(r.dust_age-r.dead_age):0),s.$$.dirty&3&&t(5,n=Math.min(1,r.age/r.dead_age)*Math.sqrt(1-l/4)),s.$$.dirty&3&&t(4,i=r.dead?l*100/2+"%":"0%"),s.$$.dirty&65&&t(3,o=r.x*u),s.$$.dirty&129&&t(2,a=r.y*c)},[r,l,a,o,i,n,u,c]}class ys extends ke{constructor(e){super(),Ee(this,e,ws,bs,ye,{item:0,tile_width:6,tile_height:7})}}function ks(s){let e,t=s[0].char+"",l;return{c(){e=p("div"),l=O(t),this.h()},l(n){e=g(n,"DIV",{class:!0,style:!0});var i=T(e);l=W(i,t),i.forEach(b),this.h()},h(){d(e,"class","tile svelte-icdim1"),E(e,"transform","translate3d("+s[0].x*s[1]+"px, "+s[0].y*s[2]+"px, 0px)")},m(n,i){K(n,e,i),_(e,l)},p(n,[i]){i&1&&t!==(t=n[0].char+"")&&rt(l,t),i&7&&E(e,"transform","translate3d("+n[0].x*n[1]+"px, "+n[0].y*n[2]+"px, 0px)")},i:J,o:J,d(n){n&&b(e)}}}function Es(s,e,t){let{tile:l}=e,{tile_width:n}=e,{tile_height:i}=e;return s.$$set=o=>{"tile"in o&&t(0,l=o.tile),"tile_width"in o&&t(1,n=o.tile_width),"tile_height"in o&&t(2,i=o.tile_height)},[l,n,i]}class Ts extends ke{constructor(e){super(),Ee(this,e,Es,ks,ye,{tile:0,tile_width:1,tile_height:2})}}function Pt(s,e,t){const l=s.slice();return l[12]=e[t],l}function zt(s,e,t){const l=s.slice();return l[15]=e[t],l}function At(s){let e,t=[],l=new Map,n,i=Ae(s[0].tiles);const o=a=>a[15].id;for(let a=0;a<i.length;a+=1){let r=zt(s,i,a),u=o(r);l.set(u,t[a]=St(u,r))}return{c(){e=p("div");for(let a=0;a<t.length;a+=1)t[a].c();this.h()},l(a){e=g(a,"DIV",{class:!0});var r=T(e);for(let u=0;u<t.length;u+=1)t[u].l(r);r.forEach(b),this.h()},h(){d(e,"class","tiles svelte-pux4ee")},m(a,r){K(a,e,r);for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(e,null);n=!0},p(a,r){r&9&&(i=Ae(a[0].tiles),$e(),t=yt(t,r,o,1,a,i,l,e,Jt,St,null,zt),et())},i(a){if(!n){for(let r=0;r<i.length;r+=1)H(t[r]);n=!0}},o(a){for(let r=0;r<t.length;r+=1)B(t[r]);n=!1},d(a){a&&b(e);for(let r=0;r<t.length;r+=1)t[r].d()}}}function St(s,e){let t,l,n;return l=new Ts({props:{tile:e[15],tile_width:e[3],tile_height:e[3]}}),{key:s,first:null,c(){t=at(),Le(l.$$.fragment),this.h()},l(i){t=at(),He(l.$$.fragment,i),this.h()},h(){this.first=t},m(i,o){K(i,t,o),Pe(l,i,o),n=!0},p(i,o){e=i;const a={};o&1&&(a.tile=e[15]),o&8&&(a.tile_width=e[3]),o&8&&(a.tile_height=e[3]),l.$set(a)},i(i){n||(H(l.$$.fragment,i),n=!0)},o(i){B(l.$$.fragment,i),n=!1},d(i){i&&b(t),ze(l,i)}}}function Vt(s){let e,t=[],l=new Map,n,i=Ae(s[0].items);const o=a=>a[12].id;for(let a=0;a<i.length;a+=1){let r=Pt(s,i,a),u=o(r);l.set(u,t[a]=Ot(u,r))}return{c(){e=p("div");for(let a=0;a<t.length;a+=1)t[a].c();this.h()},l(a){e=g(a,"DIV",{class:!0});var r=T(e);for(let u=0;u<t.length;u+=1)t[u].l(r);r.forEach(b),this.h()},h(){d(e,"class","items svelte-pux4ee")},m(a,r){K(a,e,r);for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(e,null);n=!0},p(a,r){r&9&&(i=Ae(a[0].items),$e(),t=yt(t,r,o,1,a,i,l,e,Jt,Ot,null,Pt),et())},i(a){if(!n){for(let r=0;r<i.length;r+=1)H(t[r]);n=!0}},o(a){for(let r=0;r<t.length;r+=1)B(t[r]);n=!1},d(a){a&&b(e);for(let r=0;r<t.length;r+=1)t[r].d()}}}function Ot(s,e){let t,l,n;return l=new ys({props:{item:e[12],tile_width:e[3],tile_height:e[3]}}),{key:s,first:null,c(){t=at(),Le(l.$$.fragment),this.h()},l(i){t=at(),He(l.$$.fragment,i),this.h()},h(){this.first=t},m(i,o){K(i,t,o),Pe(l,i,o),n=!0},p(i,o){e=i;const a={};o&1&&(a.item=e[12]),o&8&&(a.tile_width=e[3]),o&8&&(a.tile_height=e[3]),l.$set(a)},i(i){n||(H(l.$$.fragment,i),n=!0)},o(i){B(l.$$.fragment,i),n=!1},d(i){i&&b(t),ze(l,i)}}}function Is(s){let e,t,l=`${s[3]}px`,n=`${s[5]}px`,i=`${s[4]}px`,o=`${s[3]}px`,a=`${s[3]}px`,r,u=s[1]&&At(s),c=s[2]&&Vt(s);return{c(){e=p("div"),u&&u.c(),t=I(),c&&c.c(),this.h()},l(h){e=g(h,"DIV",{class:!0});var v=T(e);u&&u.l(v),t=N(v),c&&c.l(v),v.forEach(b),this.h()},h(){d(e,"class","habitat svelte-pux4ee"),E(e,"--tile_size",l),E(e,"--habitat_width",n),E(e,"--habitat_height",i),E(e,"--tile_height",o),E(e,"--tile_width",a)},m(h,v){K(h,e,v),u&&u.m(e,null),_(e,t),c&&c.m(e,null),r=!0},p(h,[v]){h[1]?u?(u.p(h,v),v&2&&H(u,1)):(u=At(h),u.c(),H(u,1),u.m(e,t)):u&&($e(),B(u,1,1,()=>{u=null}),et()),h[2]?c?(c.p(h,v),v&4&&H(c,1)):(c=Vt(h),c.c(),H(c,1),c.m(e,null)):c&&($e(),B(c,1,1,()=>{c=null}),et()),v&8&&l!==(l=`${h[3]}px`)&&E(e,"--tile_size",l),v&32&&n!==(n=`${h[5]}px`)&&E(e,"--habitat_width",n),v&16&&i!==(i=`${h[4]}px`)&&E(e,"--habitat_height",i),v&8&&o!==(o=`${h[3]}px`)&&E(e,"--tile_height",o),v&8&&a!==(a=`${h[3]}px`)&&E(e,"--tile_width",a)},i(h){r||(H(u),H(c),r=!0)},o(h){B(u),B(c),r=!1},d(h){h&&b(e),u&&u.d(),c&&c.d()}}}function Ns(s,e,t){let l,n,i,o,a,{state:r}=e,{tiles_wide:u}=e,{tiles_tall:c}=e,{displayWidth:h}=e,{displayHeight:v}=e,{show_tiles:D=!0}=e,{show_items:F=!0}=e;return s.$$set=m=>{"state"in m&&t(0,r=m.state),"tiles_wide"in m&&t(6,u=m.tiles_wide),"tiles_tall"in m&&t(7,c=m.tiles_tall),"displayWidth"in m&&t(8,h=m.displayWidth),"displayHeight"in m&&t(9,v=m.displayHeight),"show_tiles"in m&&t(1,D=m.show_tiles),"show_items"in m&&t(2,F=m.show_items)},s.$$.update=()=>{s.$$.dirty&320&&t(11,l=Math.floor(h/u)),s.$$.dirty&640&&t(10,n=Math.floor(v/c)),s.$$.dirty&3072&&t(3,i=Math.min(l,n)),s.$$.dirty&72&&t(5,o=u*i),s.$$.dirty&136&&t(4,a=c*i)},[r,D,F,i,a,o,u,c,h,v,n,l]}class Ds extends ke{constructor(e){super(),Ee(this,e,Ns,Is,ye,{state:0,tiles_wide:6,tiles_tall:7,displayWidth:8,displayHeight:9,show_tiles:1,show_items:2})}}const Us=(s=0)=>{let e=s;return()=>e++},Ms=(s,e,t="_")=>{const l=Us(e);return()=>`${s}${t}${l()}`},Et=(s,e,t,l)=>t===0||t===s-1||l===0||l===e-1,Cs=(s,e,t,l)=>t>=0&&l>=0&&t<s&&l<e,Wt=[-1,0,1],js=Ms("item"),Ls=.8,Hs=s=>({tiles:Ps(s),items:zs(s)}),Ps=s=>{const e=re(s.tiles_wide),t=re(s.tiles_tall),l=[];let n=0;for(let i=0;i<t;i++)for(let o=0;o<e;o++){const a=n;n++;let r;Et(e,t,o,i)?r=ot(s.ocean,s.random):r=s.land_by_wetness[s.wetness],l.push({id:`${o},${i}`,x:o,y:i,index:a,char:r})}return l},zs=s=>{const e=re(s.tiles_wide),t=re(s.tiles_tall),l=[];for(let n=0;n<t;n++)for(let i=0;i<e;i++)Et(e,t,i,n)||Kt(0,1,s.random)<Ls||l.push(Qt(s,i,n));return l},As=s=>{const e=re(s.state),t={tiles:e.tiles,items:[]},l=re(s.tiles_wide),n=re(s.tiles_tall),{items:i}=t;for(const o of e.items){const a=o.age+1,r=!o.dead&&a>o.dead_age?!0:o.dead;if(r&&a>o.dust_age)continue;const c={...o,age:a,dead:r};if(i.push(c),!(e.items.length<=e.tiles.length)||!(!o.dead&&o.age>=o.reproduction_age)||!(Kt(0,1,s.random)<o.reproduction*re(s.reproduction)))continue;const F=ot(Wt,s.random),m=ot(Wt,s.random),C=c.x+F,P=c.y+m;if(!Et(l,n,C,P)&&Cs(l,n,C,P)&&!Bt(e.items,C,P)&&!Bt(i,C,P)){const z=Qt(s,C,P,{char:c.char,age:0});i.push(z)}}return t},Bt=(s,e,t)=>{for(const l of s)if(l.x===e&&l.y===t)return l},Qt=(s,e,t,l)=>{const n=(l==null?void 0:l.age)??kt(0,10,s.random),i=5,o=5,a=10;return{id:js(),x:e,y:t,dead:n>=a,dead_age:a,dust_age:a+o,reproduction:1,reproduction_age:i,...l,age:n,char:(l==null?void 0:l.char)??ot(s.trees,s.random)}},Ft=(...s)=>{let e=0,t=0,l=0,n=1;const i=s.length?s:[Date.now()];let o=Ss();e=o(" "),t=o(" "),l=o(" ");for(const r of i)e-=o(r),e<0&&(e+=1),t-=o(r),t<0&&(t+=1),l-=o(r),l<0&&(l+=1);o=null;const a=()=>{const r=2091639*e+n*23283064365386963e-26;return e=t,t=l,l=r-(n=r|0)};return a.uint32=()=>a()*4294967296,a.fract53=()=>a()+(a()*2097152|0)*11102230246251565e-32,a.version="Alea 0.9",a.seeds=i,a},Ss=()=>{let s=4022871197;return e=>{const t=e+"";for(let l=0;l<t.length;l++){s+=t.charCodeAt(l);let n=.02519603282416938*s;s=n>>>0,n-=s,n*=s,s=n>>>0,n-=s,s+=n*4294967296}return(s>>>0)*23283064365386963e-26}};class Vs{constructor(e,t,l=10,n=10){G(this,"seed",we(1));G(this,"random",Ft(re(this.seed)));G(this,"tiles_wide");G(this,"tiles_tall");G(this,"state");G(this,"turn",we(0));G(this,"reproduction",we(.5));G(this,"wetness",3);G(this,"land_by_wetness",["🟧","🟨","🟫","🟩","🟦"]);G(this,"ocean",[...("🔵".repeat(4)+"🌊").repeat(8)+"🏝"]);G(this,"mountains",["⛰","🏔","🌋","🗻","🏞"]);G(this,"trees",["🌲","🌳"]);this.create_habitat_state=e,this.simulate_habitat=t,this.tiles_wide=we(l),this.tiles_tall=we(n),this.state=we(this.create_habitat_state(this))}resize(e,t){this.tiles_wide.set(e),this.tiles_tall.set(t),this.reset()}setSeed(e){this.seed.set(e),this.reset()}reset(){this.random=Ft(re(this.seed)),this.state.set(this.create_habitat_state(this)),this.turn.set(0)}simulate(){this.state.set(this.simulate_habitat(this)),this.turn.update(e=>e+1)}}function Rt(s,e,t){const l=s.slice();return l[5]=e[t],l}function qt(s,e){let t,l=e[5]+"",n,i,o,a;function r(){return e[4](e[5])}return{key:s,first:null,c(){t=p("button"),n=O(l),i=I(),this.h()},l(u){t=g(u,"BUTTON",{type:!0,class:!0});var c=T(t);n=W(c,l),i=N(c),c.forEach(b),this.h()},h(){d(t,"type","button"),d(t,"class","svelte-t95ngd"),je(t,"selected",e[2].includes(e[5])),this.first=t},m(u,c){K(u,t,c),_(t,n),_(t,i),o||(a=L(t,"click",r),o=!0)},p(u,c){e=u,c&1&&l!==(l=e[5]+"")&&rt(n,l),c&5&&je(t,"selected",e[2].includes(e[5]))},d(u){u&&b(t),o=!1,a()}}}function Os(s){let e,t=[],l=new Map,n=Ae(s[0]);const i=o=>o[5];for(let o=0;o<n.length;o+=1){let a=Rt(s,n,o),r=i(a);l.set(r,t[o]=qt(r,a))}return{c(){e=p("fieldset");for(let o=0;o<t.length;o+=1)t[o].c();this.h()},l(o){e=g(o,"FIELDSET",{class:!0});var a=T(e);for(let r=0;r<t.length;r+=1)t[r].l(a);a.forEach(b),this.h()},h(){d(e,"class","svelte-t95ngd")},m(o,a){K(o,e,a);for(let r=0;r<t.length;r+=1)t[r]&&t[r].m(e,null)},p(o,[a]){a&13&&(n=Ae(o[0]),t=yt(t,a,i,1,o,n,l,e,ds,qt,null,Rt))},i:J,o:J,d(o){o&&b(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function Ws(s,e,t){let l,n=J,i=()=>(n(),n=ns(a,c=>t(2,l=c)),a);s.$$.on_destroy.push(()=>n());let{emojis:o}=e,{selected_emojis:a}=e;i();const r=c=>{Gt(a,l=l.includes(c)?l.filter(h=>h!==c):l.concat(c),l)},u=c=>r(c);return s.$$set=c=>{"emojis"in c&&t(0,o=c.emojis),"selected_emojis"in c&&i(t(1,a=c.selected_emojis))},[o,a,l,r,u]}class Bs extends ke{constructor(e){super(),Ee(this,e,Ws,Os,ye,{emojis:0,selected_emojis:1})}}function Xt(s){let e,t;return e=new Ds({props:{state:s[16],tiles_wide:s[3],tiles_tall:s[4],displayWidth:s[13],displayHeight:s[12],show_tiles:s[7],show_items:s[8]}}),{c(){Le(e.$$.fragment)},l(l){He(e.$$.fragment,l)},m(l,n){Pe(e,l,n),t=!0},p(l,n){const i={};n[0]&65536&&(i.state=l[16]),n[0]&8&&(i.tiles_wide=l[3]),n[0]&16&&(i.tiles_tall=l[4]),n[0]&8192&&(i.displayWidth=l[13]),n[0]&4096&&(i.displayHeight=l[12]),n[0]&128&&(i.show_tiles=l[7]),n[0]&256&&(i.show_items=l[8]),e.$set(i)},i(l){t||(H(e.$$.fragment,l),t=!0)},o(l){B(e.$$.fragment,l),t=!1},d(l){ze(e,l)}}}function Fs(s){let e;return{c(){e=O("play")},l(t){e=W(t,"play")},m(t,l){K(t,e,l)},d(t){t&&b(e)}}}function Rs(s){let e;return{c(){e=O("pause")},l(t){e=W(t,"pause")},m(t,l){K(t,e,l)},d(t){t&&b(e)}}}function qs(s){let e,t,l,n,i,o,a,r,u,c,h,v,D,F,m,C="tick",P,z,Te="reset",S,te,Q,he,R,Se,V,Ie,Y,se="randomize",Ne,Z,De,A,x,q,Ve,le,Oe,X,We,ie,Be,ne,Fe,$,Re,ae,w,y,ue,ee,ut,_e,_t,fe,me,pe,ct,dt,ge,ve,ft,ht,Ue,ce,Me,Tt="source code",mt,be,It="🌵",xt=`${xe}px`,Nt,tt,oe,pt,j,gt,Dt;Ht(s[35]);let U=s[13]>0&&Xt(s);o=new Bs({props:{emojis:s[18],selected_emojis:s[19]}});function Ut(f,k){return f[10]?Rs:Fs}let st=Ut(s),de=st(s);function $t(f){s[41](f)}let Mt={};return s[9]!==void 0&&(Mt.post_message=s[9]),oe=new gs({props:Mt}),as.push(()=>_s(oe,"post_message",$t)),oe.$on("message",s[42]),{c(){e=p("div"),t=p("div"),U&&U.c(),l=I(),n=p("div"),i=p("form"),Le(o.$$.fragment),a=I(),r=p("div"),u=O("turn "),c=O(s[17]),h=I(),v=p("fieldset"),D=p("button"),de.c(),F=I(),m=p("button"),m.textContent=C,P=I(),z=p("button"),z.textContent=Te,S=I(),te=p("fieldset"),Q=p("label"),he=O(`seed
					`),R=p("input"),Se=I(),V=p("input"),Ie=I(),Y=p("button"),Y.textContent=se,Ne=I(),Z=p("label"),De=O(`turn duration
				`),A=p("input"),x=I(),q=p("input"),Ve=I(),le=p("label"),Oe=O(`reproduction rate
				`),X=p("input"),We=I(),ie=p("input"),Be=I(),ne=p("label"),Fe=O(`tiles wide
				`),$=p("input"),Re=I(),ae=p("input"),w=I(),y=p("label"),ue=O(`tiles tall
				`),ee=p("input"),ut=I(),_e=p("input"),_t=I(),fe=p("fieldset"),me=p("label"),pe=p("input"),ct=O(`
					show tiles`),dt=I(),ge=p("label"),ve=p("input"),ft=O(`
					show items`),ht=I(),Ue=p("footer"),ce=p("a"),Me=p("div"),Me.textContent=Tt,mt=I(),be=p("div"),be.textContent=It,tt=I(),Le(oe.$$.fragment),this.h()},l(f){e=g(f,"DIV",{class:!0});var k=T(e);t=g(k,"DIV",{class:!0,style:!0});var qe=T(t);U&&U.l(qe),qe.forEach(b),l=N(k),n=g(k,"DIV",{class:!0});var Ct=T(n);i=g(Ct,"FORM",{});var M=T(i);He(o.$$.fragment,M),a=N(M),r=g(M,"DIV",{class:!0});var vt=T(r);u=W(vt,"turn "),c=W(vt,s[17]),vt.forEach(b),h=N(M),v=g(M,"FIELDSET",{class:!0});var Ce=T(v);D=g(Ce,"BUTTON",{type:!0,class:!0});var jt=T(D);de.l(jt),jt.forEach(b),F=N(Ce),m=g(Ce,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),Ye(m)!=="svelte-1kws75n"&&(m.textContent=C),P=N(Ce),z=g(Ce,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),Ye(z)!=="svelte-1yi2hpt"&&(z.textContent=Te),Ce.forEach(b),S=N(M),te=g(M,"FIELDSET",{class:!0});var lt=T(te);Q=g(lt,"LABEL",{class:!0});var Xe=T(Q);he=W(Xe,`seed
					`),R=g(Xe,"INPUT",{type:!0,step:!0,min:!0,max:!0}),Se=N(Xe),V=g(Xe,"INPUT",{type:!0,class:!0}),Xe.forEach(b),Ie=N(lt),Y=g(lt,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),Ye(Y)!=="svelte-13z5mpb"&&(Y.textContent=se),lt.forEach(b),Ne=N(M),Z=g(M,"LABEL",{class:!0});var Ge=T(Z);De=W(Ge,`turn duration
				`),A=g(Ge,"INPUT",{type:!0,step:!0,min:!0,max:!0}),x=N(Ge),q=g(Ge,"INPUT",{type:!0,class:!0}),Ge.forEach(b),Ve=N(M),le=g(M,"LABEL",{class:!0});var Je=T(le);Oe=W(Je,`reproduction rate
				`),X=g(Je,"INPUT",{type:!0,step:!0,min:!0,max:!0}),We=N(Je),ie=g(Je,"INPUT",{type:!0,class:!0}),Je.forEach(b),Be=N(M),ne=g(M,"LABEL",{class:!0});var Ke=T(ne);Fe=W(Ke,`tiles wide
				`),$=g(Ke,"INPUT",{type:!0,step:!0,min:!0,max:!0}),Re=N(Ke),ae=g(Ke,"INPUT",{type:!0,class:!0}),Ke.forEach(b),w=N(M),y=g(M,"LABEL",{class:!0});var Qe=T(y);ue=W(Qe,`tiles tall
				`),ee=g(Qe,"INPUT",{type:!0,step:!0,min:!0,max:!0}),ut=N(Qe),_e=g(Qe,"INPUT",{type:!0,class:!0}),Qe.forEach(b),_t=N(M),fe=g(M,"FIELDSET",{class:!0});var it=T(fe);me=g(it,"LABEL",{class:!0});var bt=T(me);pe=g(bt,"INPUT",{type:!0}),ct=W(bt,`
					show tiles`),bt.forEach(b),dt=N(it),ge=g(it,"LABEL",{class:!0});var wt=T(ge);ve=g(wt,"INPUT",{type:!0}),ft=W(wt,`
					show items`),wt.forEach(b),it.forEach(b),ht=N(M),Ue=g(M,"FOOTER",{class:!0});var Lt=T(Ue);ce=g(Lt,"A",{href:!0,class:!0});var nt=T(ce);Me=g(nt,"DIV",{"data-svelte-h":!0}),Ye(Me)!=="svelte-4deh8w"&&(Me.textContent=Tt),mt=N(nt),be=g(nt,"DIV",{"data-svelte-h":!0}),Ye(be)!=="svelte-18w2oa3"&&(be.textContent=It),nt.forEach(b),Lt.forEach(b),M.forEach(b),Ct.forEach(b),k.forEach(b),tt=N(f),He(oe.$$.fragment,f),this.h()},h(){d(t,"class","world svelte-15fo7rn"),E(t,"--animation_duration",s[11]+"ms"),d(r,"class","turn svelte-15fo7rn"),d(D,"type","button"),d(D,"class","svelte-15fo7rn"),E(D,"flex","1"),d(m,"type","button"),d(m,"class","svelte-15fo7rn"),d(z,"type","button"),d(z,"class","svelte-15fo7rn"),d(v,"class","row svelte-15fo7rn"),d(R,"type","range"),R.value=s[14],d(R,"step",1),d(R,"min",Yt),d(R,"max",Zt),d(V,"type","text"),V.value=s[14],d(V,"class","svelte-15fo7rn"),d(Q,"class","seed-label svelte-15fo7rn"),d(Y,"type","button"),d(Y,"class","svelte-15fo7rn"),d(te,"class","svelte-15fo7rn"),d(A,"type","range"),A.value=s[5],d(A,"step",1e3/60),d(A,"min",s[24]),d(A,"max",Qs),d(q,"type","number"),q.value=s[5],d(q,"class","svelte-15fo7rn"),d(Z,"class","svelte-15fo7rn"),d(X,"type","range"),X.value=s[15],d(X,"step",.01),d(X,"min",0),d(X,"max",1),d(ie,"type","number"),ie.value=s[15],d(ie,"class","svelte-15fo7rn"),d(le,"class","svelte-15fo7rn"),d($,"type","range"),$.value=s[3],d($,"step",1),d($,"min",Xs),d($,"max",Gs),d(ae,"type","number"),ae.value=s[3],d(ae,"class","svelte-15fo7rn"),d(ne,"class","svelte-15fo7rn"),d(ee,"type","range"),ee.value=s[4],d(ee,"step",1),d(ee,"min",Js),d(ee,"max",Ks),d(_e,"type","number"),_e.value=s[4],d(_e,"class","svelte-15fo7rn"),d(y,"class","svelte-15fo7rn"),d(pe,"type","checkbox"),pe.checked=s[7],d(me,"class","svelte-15fo7rn"),d(ve,"type","checkbox"),ve.checked=s[8],d(ge,"class","svelte-15fo7rn"),d(fe,"class","row svelte-15fo7rn"),E(be,"font-size","var(--icon_size_md)"),d(ce,"href","https://github.com/feltjs/felt-habitat"),d(ce,"class","box"),d(Ue,"class","box svelte-15fo7rn"),E(i,"max-width",xt),d(n,"class","controls svelte-15fo7rn"),E(n,"width",s[6]?"100%":xe+"px"),E(n,"height",s[6]?s[12]+"px":"100%"),d(e,"class","universe svelte-15fo7rn"),Ht(()=>s[40].call(e)),je(e,"vertical",s[6])},m(f,k){K(f,e,k),_(e,t),U&&U.m(t,null),_(e,l),_(e,n),_(n,i),Pe(o,i,null),_(i,a),_(i,r),_(r,u),_(r,c),_(i,h),_(i,v),_(v,D),de.m(D,null),_(v,F),_(v,m),_(v,P),_(v,z),_(i,S),_(i,te),_(te,Q),_(Q,he),_(Q,R),_(Q,Se),_(Q,V),_(te,Ie),_(te,Y),_(i,Ne),_(i,Z),_(Z,De),_(Z,A),_(Z,x),_(Z,q),_(i,Ve),_(i,le),_(le,Oe),_(le,X),_(le,We),_(le,ie),_(i,Be),_(i,ne),_(ne,Fe),_(ne,$),_(ne,Re),_(ne,ae),_(i,w),_(i,y),_(y,ue),_(y,ee),_(y,ut),_(y,_e),_(i,_t),_(i,fe),_(fe,me),_(me,pe),_(me,ct),_(fe,dt),_(fe,ge),_(ge,ve),_(ge,ft),_(i,ht),_(i,Ue),_(Ue,ce),_(ce,Me),_(ce,mt),_(ce,be),Nt=os(e,s[40].bind(e)),K(f,tt,k),Pe(oe,f,k),j=!0,gt||(Dt=[L(window,"resize",s[35]),L(D,"click",s[36]),L(m,"click",s[37]),L(z,"click",s[38]),L(R,"input",s[29]("seed")),L(V,"input",s[28]("seed")),L(Y,"click",s[39]),L(A,"input",s[29]("turn_duration")),L(q,"input",s[29]("turn_duration")),L(X,"input",s[29]("reproduction_rate")),L(ie,"input",s[29]("reproduction_rate")),L($,"input",s[29]("tiles_wide")),L(ae,"input",s[29]("tiles_wide")),L(ee,"input",s[29]("tiles_tall")),L(_e,"input",s[29]("tiles_tall")),L(pe,"input",s[30]("show_tiles")),L(ve,"input",s[30]("show_items"))],gt=!0)},p(f,k){f[13]>0?U?(U.p(f,k),k[0]&8192&&H(U,1)):(U=Xt(f),U.c(),H(U,1),U.m(t,null)):U&&($e(),B(U,1,1,()=>{U=null}),et()),(!j||k[0]&2048)&&E(t,"--animation_duration",f[11]+"ms"),(!j||k[0]&131072)&&rt(c,f[17]),st!==(st=Ut(f))&&(de.d(1),de=st(f),de&&(de.c(),de.m(D,null))),(!j||k[0]&16384)&&(R.value=f[14]),(!j||k[0]&16384&&V.value!==f[14])&&(V.value=f[14]),(!j||k[0]&32)&&(A.value=f[5]),(!j||k[0]&32&&q.value!==f[5])&&(q.value=f[5]),(!j||k[0]&32768)&&(X.value=f[15]),(!j||k[0]&32768&&ie.value!==f[15])&&(ie.value=f[15]),(!j||k[0]&8)&&($.value=f[3]),(!j||k[0]&8&&ae.value!==f[3])&&(ae.value=f[3]),(!j||k[0]&16)&&(ee.value=f[4]),(!j||k[0]&16&&_e.value!==f[4])&&(_e.value=f[4]),(!j||k[0]&128)&&(pe.checked=f[7]),(!j||k[0]&256)&&(ve.checked=f[8]),k[0]&64&&E(n,"width",f[6]?"100%":xe+"px"),k[0]&4160&&E(n,"height",f[6]?f[12]+"px":"100%"),(!j||k[0]&64)&&je(e,"vertical",f[6]);const qe={};!pt&&k[0]&512&&(pt=!0,qe.post_message=f[9],rs(()=>pt=!1)),oe.$set(qe)},i(f){j||(H(U),H(o.$$.fragment,f),H(oe.$$.fragment,f),j=!0)},o(f){B(U),B(o.$$.fragment,f),B(oe.$$.fragment,f),j=!1},d(f){f&&(b(e),b(tt)),U&&U.d(),ze(o),de.d(),Nt(),ze(oe,f),gt=!1,us(Dt)}}}const xe=300,Xs=3,Gs=33,Js=3,Ks=33,Yt=0,Zt=9999,Qs=2e3;function Ys(s,e,t){let l,n,i,o,a,r,u,c,h,v;const D=["🌲","🌳","🌴","🌵"],F=we(D.slice(0,2));Ze(s,F,w=>t(34,c=w));let m=0,C=0,P=0,z=13,Te=10;const S=new Vs(Hs,As),{turn:te,state:Q,reproduction:he,seed:R}=S;Ze(s,te,w=>t(17,v=w)),Ze(s,Q,w=>t(16,h=w)),Ze(s,he,w=>t(15,u=w)),Ze(s,R,w=>t(14,r=w));const Se=1e3/30;let V=1e3,Ie=!0,Y=!0,se=null;const Ne=()=>{x(se?{type:"habitat.stop"}:{type:"habitat.start"})},Z=()=>{se===null&&t(33,se=setInterval(()=>{S.simulate()},V))},De=()=>{se!==null&&(clearInterval(se),t(33,se=null))};let A;const x=w=>{A({type:"Ephemera",params:w}),q(w)},q=w=>{switch(console.log("updateHabitat message",w),w.type){case"habitat.start":{Z();break}case"habitat.stop":{De();break}case"habitat.reset":{S.reset();break}case"habitat.next_turn":{S.simulate();break}case"habitat.update_state":{const{value:y}=w;y.tiles_wide!==void 0&&t(3,z=y.tiles_wide),y.tiles_tall!==void 0&&t(4,Te=y.tiles_tall),y.show_tiles!==void 0&&t(7,Ie=y.show_tiles),y.show_items!==void 0&&t(8,Y=y.show_items),y.turn_duration!==void 0&&t(5,V=y.turn_duration),y.reproduction_rate!==void 0&&Gt(he,u=y.reproduction_rate,u),y.seed!==void 0&&S.setSeed(y.seed);break}default:throw new vs(w)}},Ve=w=>y=>{const ue=/^[\d\.]+$/u.test(y.target.value)?parseFloat(y.target.value):y.target.value,ee=Number.isNaN(ue)?y.target.value:ue;x({type:"habitat.update_state",value:{[w]:ee}})},le=w=>y=>{x({type:"habitat.update_state",value:{[w]:Number(y.target.value)}})},Oe=w=>y=>{x({type:"habitat.update_state",value:{[w]:y.target.checked}})},X=()=>{let w;do w=kt(Yt,Zt,S.random);while(w===r);return w};function We(){t(0,m=window.innerWidth)}const ie=()=>Ne(),Be=()=>x({type:"habitat.next_turn"}),ne=()=>x({type:"habitat.reset"}),Fe=()=>x({type:"habitat.update_state",value:{seed:X()}});function $(){C=this.clientWidth,P=this.clientHeight,t(1,C),t(2,P)}function Re(w){A=w,t(9,A)}const ae=w=>{var ue;console.log("message from window host e",w.detail),((ue=w.detail)==null?void 0:ue.data)&&q(w.detail.data)};return s.$$.update=()=>{s.$$.dirty[0]&1&&t(6,l=m<xe*2.5),s.$$.dirty[1]&8&&t(32,S.trees=c,S),s.$$.dirty[0]&24|s.$$.dirty[1]&2&&S.resize(z,Te),s.$$.dirty[0]&66&&t(13,n=l?C:C-xe),s.$$.dirty[0]&68&&t(12,i=l?P/2:P),s.$$.dirty[0]&32&&t(11,o=Math.max(16.67,V*.95-16.67)),s.$$.dirty[0]&32&&(De(),Z()),s.$$.dirty[1]&4&&t(10,a=se!==null)},[m,C,P,z,Te,V,l,Ie,Y,A,a,o,i,n,r,u,h,v,D,F,te,Q,he,R,Se,Ne,x,q,Ve,le,Oe,X,S,se,c,We,ie,Be,ne,Fe,$,Re,ae]}class Zs extends ke{constructor(e){super(),Ee(this,e,Ys,qs,ye,{},null,[-1,-1])}}function xs(s){let e,t;return e=new Zs({}),{c(){Le(e.$$.fragment)},l(l){He(e.$$.fragment,l)},m(l,n){Pe(e,l,n),t=!0},p:J,i(l){t||(H(e.$$.fragment,l),t=!0)},o(l){B(e.$$.fragment,l),t=!1},d(l){ze(e,l)}}}class il extends ke{constructor(e){super(),Ee(this,e,null,xs,ye,{})}}export{il as component};
