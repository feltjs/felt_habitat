var ls=Object.defineProperty;var is=(s,e,t)=>e in s?ls(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var G=(s,e,t)=>(is(s,typeof e!="symbol"?e+"":e,t),t);import{n as Ee,C as J,G as L,E as ns,o as as,F as os,b as p,k as S,f as g,g as T,l as B,d as v,h as f,J as ze,j as E,i as K,x as _,m as _t,s as I,c as N,e as rt,Q as re,D as rs,P as Qt,R as Vt,p as us,L as Le,S as _s,U as cs,K as fs,O as xe}from"../chunks/scheduler.34d16e1e.js";import{S as Te,i as Ie,a as z,g as et,t as H,c as tt,b as Ae,d as Pe,m as Ve,e as Fe,f as hs}from"../chunks/index.d22a2a6f.js";import{w as ke}from"../chunks/index.f5084c78.js";import{b as ds}from"../chunks/paths.9a8d399b.js";import{g as ms}from"../chunks/globals.7f7f1b26.js";import{e as Oe,u as Tt,o as Yt,d as ps}from"../chunks/each.f14f0ca5.js";class gs extends Error{constructor(e,t=`Unreachable case: ${e}`){super(t)}}const Zt=(s,e,t=Math.random)=>t()*(e-s)+s,It=(s,e,t=Math.random)=>Math.floor(t()*(e-s+1))+s,ut=(s,e=Math.random)=>s[It(0,s.length-1,e)],{window:ws}=ms;function vs(s){let e,t;return{c:J,l:J,m(l,n){e||(t=L(ws,"message",s[0]),e=!0)},p:J,i:J,o:J,d(l){e=!1,t()}}}const bs=6e3;function ys(s,e,t){let{host:l=typeof window<"u"&&window.parent!==window?window.parent:null}=e,{target_origin:n="*"}=e,{connect_on_mount:i=!0}=e;const o=ns(),a=m=>{l&&(l instanceof ServiceWorker||l instanceof MessagePort?l.postMessage(m):l.postMessage(m,n))};as(async()=>{i&&await U()}),os(()=>{w&&clearTimeout(w)});let r="initial",u,c,d,w;const U=async()=>l?u&&c===l?u:(c=l,u=new Promise(m=>{d=m,r="pending",a({type:"felt.connect"}),w=setTimeout(()=>{r="failure",u=void 0,w=void 0,d(!1),d=void 0},bs)})):!1,R=m=>{if(m.source!==l)return;const C=m.data;if(C){if(C.type==="felt.connected"){if(r!=="pending")return;r="success",clearTimeout(w),w=void 0,d(!0),d=void 0}C.type&&r==="success"&&o("message",C)}};return s.$$set=m=>{"host"in m&&t(1,l=m.host),"target_origin"in m&&t(2,n=m.target_origin),"connect_on_mount"in m&&t(3,i=m.connect_on_mount)},[R,l,n,i,a,U]}class ks extends Te{constructor(e){super(),Ie(this,e,ys,vs,Ee,{host:1,target_origin:2,connect_on_mount:3,post_message:4,connect:5})}get post_message(){return this.$$.ctx[4]}get connect(){return this.$$.ctx[5]}}function Es(s){let e,t,l=s[0].char+"",n;return{c(){e=p("div"),t=p("div"),n=S(l),this.h()},l(i){e=g(i,"DIV",{class:!0,style:!0});var o=T(e);t=g(o,"DIV",{class:!0});var a=T(t);n=B(a,l),a.forEach(v),o.forEach(v),this.h()},h(){f(t,"class","svelte-10gyibm"),ze(t,"dead",s[0].dead),f(e,"class","item svelte-10gyibm"),E(e,"transform","translate3d("+s[3]+"px, "+s[2]+"px, 0px) scale3d("+s[5]+", "+s[5]+", "+s[5]+")"),E(e,"--grayscale",s[4]),E(e,"opacity",1-s[1])},m(i,o){K(i,e,o),_(e,t),_(t,n)},p(i,[o]){o&1&&l!==(l=i[0].char+"")&&_t(n,l),o&1&&ze(t,"dead",i[0].dead),o&44&&E(e,"transform","translate3d("+i[3]+"px, "+i[2]+"px, 0px) scale3d("+i[5]+", "+i[5]+", "+i[5]+")"),o&16&&E(e,"--grayscale",i[4]),o&2&&E(e,"opacity",1-i[1])},i:J,o:J,d(i){i&&v(e)}}}function Ts(s,e,t){let l,n,i,o,a,{item:r}=e,{tile_width:u}=e,{tile_height:c}=e;return s.$$set=d=>{"item"in d&&t(0,r=d.item),"tile_width"in d&&t(6,u=d.tile_width),"tile_height"in d&&t(7,c=d.tile_height)},s.$$.update=()=>{s.$$.dirty&1&&t(1,l=r.dead?(r.age-r.dead_age)/(r.dust_age-r.dead_age):0),s.$$.dirty&3&&t(5,n=Math.min(1,r.age/r.dead_age)*Math.sqrt(1-l/4)),s.$$.dirty&3&&t(4,i=r.dead?l*100/2+"%":"0%"),s.$$.dirty&65&&t(3,o=r.x*u),s.$$.dirty&129&&t(2,a=r.y*c)},[r,l,a,o,i,n,u,c]}class Is extends Te{constructor(e){super(),Ie(this,e,Ts,Es,Ee,{item:0,tile_width:6,tile_height:7})}}function Ns(s){let e,t=s[0].char+"",l;return{c(){e=p("div"),l=S(t),this.h()},l(n){e=g(n,"DIV",{class:!0,style:!0});var i=T(e);l=B(i,t),i.forEach(v),this.h()},h(){f(e,"class","tile svelte-icdim1"),E(e,"transform","translate3d("+s[0].x*s[1]+"px, "+s[0].y*s[2]+"px, 0px)")},m(n,i){K(n,e,i),_(e,l)},p(n,[i]){i&1&&t!==(t=n[0].char+"")&&_t(l,t),i&7&&E(e,"transform","translate3d("+n[0].x*n[1]+"px, "+n[0].y*n[2]+"px, 0px)")},i:J,o:J,d(n){n&&v(e)}}}function Us(s,e,t){let{tile:l}=e,{tile_width:n}=e,{tile_height:i}=e;return s.$$set=o=>{"tile"in o&&t(0,l=o.tile),"tile_width"in o&&t(1,n=o.tile_width),"tile_height"in o&&t(2,i=o.tile_height)},[l,n,i]}class Ds extends Te{constructor(e){super(),Ie(this,e,Us,Ns,Ee,{tile:0,tile_width:1,tile_height:2})}}function Ft(s,e,t){const l=s.slice();return l[12]=e[t],l}function Ot(s,e,t){const l=s.slice();return l[15]=e[t],l}function St(s){let e,t=[],l=new Map,n,i=Oe(s[0].tiles);const o=a=>a[15].id;for(let a=0;a<i.length;a+=1){let r=Ot(s,i,a),u=o(r);l.set(u,t[a]=Bt(u,r))}return{c(){e=p("div");for(let a=0;a<t.length;a+=1)t[a].c();this.h()},l(a){e=g(a,"DIV",{class:!0});var r=T(e);for(let u=0;u<t.length;u+=1)t[u].l(r);r.forEach(v),this.h()},h(){f(e,"class","tiles svelte-pux4ee")},m(a,r){K(a,e,r);for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(e,null);n=!0},p(a,r){r&9&&(i=Oe(a[0].tiles),et(),t=Tt(t,r,o,1,a,i,l,e,Yt,Bt,null,Ot),tt())},i(a){if(!n){for(let r=0;r<i.length;r+=1)z(t[r]);n=!0}},o(a){for(let r=0;r<t.length;r+=1)H(t[r]);n=!1},d(a){a&&v(e);for(let r=0;r<t.length;r+=1)t[r].d()}}}function Bt(s,e){let t,l,n;return l=new Ds({props:{tile:e[15],tile_width:e[3],tile_height:e[3]}}),{key:s,first:null,c(){t=rt(),Ae(l.$$.fragment),this.h()},l(i){t=rt(),Pe(l.$$.fragment,i),this.h()},h(){this.first=t},m(i,o){K(i,t,o),Ve(l,i,o),n=!0},p(i,o){e=i;const a={};o&1&&(a.tile=e[15]),o&8&&(a.tile_width=e[3]),o&8&&(a.tile_height=e[3]),l.$set(a)},i(i){n||(z(l.$$.fragment,i),n=!0)},o(i){H(l.$$.fragment,i),n=!1},d(i){i&&v(t),Fe(l,i)}}}function Ht(s){let e,t=[],l=new Map,n,i=Oe(s[0].items);const o=a=>a[12].id;for(let a=0;a<i.length;a+=1){let r=Ft(s,i,a),u=o(r);l.set(u,t[a]=Rt(u,r))}return{c(){e=p("div");for(let a=0;a<t.length;a+=1)t[a].c();this.h()},l(a){e=g(a,"DIV",{class:!0});var r=T(e);for(let u=0;u<t.length;u+=1)t[u].l(r);r.forEach(v),this.h()},h(){f(e,"class","items svelte-pux4ee")},m(a,r){K(a,e,r);for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(e,null);n=!0},p(a,r){r&9&&(i=Oe(a[0].items),et(),t=Tt(t,r,o,1,a,i,l,e,Yt,Rt,null,Ft),tt())},i(a){if(!n){for(let r=0;r<i.length;r+=1)z(t[r]);n=!0}},o(a){for(let r=0;r<t.length;r+=1)H(t[r]);n=!1},d(a){a&&v(e);for(let r=0;r<t.length;r+=1)t[r].d()}}}function Rt(s,e){let t,l,n;return l=new Is({props:{item:e[12],tile_width:e[3],tile_height:e[3]}}),{key:s,first:null,c(){t=rt(),Ae(l.$$.fragment),this.h()},l(i){t=rt(),Pe(l.$$.fragment,i),this.h()},h(){this.first=t},m(i,o){K(i,t,o),Ve(l,i,o),n=!0},p(i,o){e=i;const a={};o&1&&(a.item=e[12]),o&8&&(a.tile_width=e[3]),o&8&&(a.tile_height=e[3]),l.$set(a)},i(i){n||(z(l.$$.fragment,i),n=!0)},o(i){H(l.$$.fragment,i),n=!1},d(i){i&&v(t),Fe(l,i)}}}function Ms(s){let e,t,l=`${s[3]}px`,n=`${s[5]}px`,i=`${s[4]}px`,o=`${s[3]}px`,a=`${s[3]}px`,r,u=s[1]&&St(s),c=s[2]&&Ht(s);return{c(){e=p("div"),u&&u.c(),t=I(),c&&c.c(),this.h()},l(d){e=g(d,"DIV",{class:!0});var w=T(e);u&&u.l(w),t=N(w),c&&c.l(w),w.forEach(v),this.h()},h(){f(e,"class","habitat svelte-pux4ee"),E(e,"--tile_size",l),E(e,"--habitat_width",n),E(e,"--habitat_height",i),E(e,"--tile_height",o),E(e,"--tile_width",a)},m(d,w){K(d,e,w),u&&u.m(e,null),_(e,t),c&&c.m(e,null),r=!0},p(d,[w]){d[1]?u?(u.p(d,w),w&2&&z(u,1)):(u=St(d),u.c(),z(u,1),u.m(e,t)):u&&(et(),H(u,1,1,()=>{u=null}),tt()),d[2]?c?(c.p(d,w),w&4&&z(c,1)):(c=Ht(d),c.c(),z(c,1),c.m(e,null)):c&&(et(),H(c,1,1,()=>{c=null}),tt()),w&8&&l!==(l=`${d[3]}px`)&&E(e,"--tile_size",l),w&32&&n!==(n=`${d[5]}px`)&&E(e,"--habitat_width",n),w&16&&i!==(i=`${d[4]}px`)&&E(e,"--habitat_height",i),w&8&&o!==(o=`${d[3]}px`)&&E(e,"--tile_height",o),w&8&&a!==(a=`${d[3]}px`)&&E(e,"--tile_width",a)},i(d){r||(z(u),z(c),r=!0)},o(d){H(u),H(c),r=!1},d(d){d&&v(e),u&&u.d(),c&&c.d()}}}function Cs(s,e,t){let l,n,i,o,a,{state:r}=e,{tiles_wide:u}=e,{tiles_tall:c}=e,{display_width:d}=e,{display_height:w}=e,{show_tiles:U=!0}=e,{show_items:R=!0}=e;return s.$$set=m=>{"state"in m&&t(0,r=m.state),"tiles_wide"in m&&t(6,u=m.tiles_wide),"tiles_tall"in m&&t(7,c=m.tiles_tall),"display_width"in m&&t(8,d=m.display_width),"display_height"in m&&t(9,w=m.display_height),"show_tiles"in m&&t(1,U=m.show_tiles),"show_items"in m&&t(2,R=m.show_items)},s.$$.update=()=>{s.$$.dirty&320&&t(11,l=Math.floor(d/u)),s.$$.dirty&640&&t(10,n=Math.floor(w/c)),s.$$.dirty&3072&&t(3,i=Math.min(l,n)),s.$$.dirty&72&&t(5,o=u*i),s.$$.dirty&136&&t(4,a=c*i)},[r,U,R,i,a,o,u,c,d,w,n,l]}class js extends Te{constructor(e){super(),Ie(this,e,Cs,Ms,Ee,{state:0,tiles_wide:6,tiles_tall:7,display_width:8,display_height:9,show_tiles:1,show_items:2})}}const Ls=(s=0)=>{let e=s;return()=>e++},zs=(s,e,t="_")=>{const l=Ls(e);return()=>`${s}${t}${l()}`},Nt=(s,e,t,l)=>t===0||t===s-1||l===0||l===e-1,As=(s,e,t,l)=>t>=0&&l>=0&&t<s&&l<e,Wt=[-1,0,1],Ps=zs("item"),Vs=.8,Fs=s=>({tiles:Os(s),items:Ss(s)}),Os=s=>{const e=re(s.tiles_wide),t=re(s.tiles_tall),l=[];let n=0;for(let i=0;i<t;i++)for(let o=0;o<e;o++){const a=n;n++;let r;Nt(e,t,o,i)?r=ut(s.ocean,s.random):r=s.land_by_wetness[s.wetness],l.push({id:`${o},${i}`,x:o,y:i,index:a,char:r})}return l},Ss=s=>{const e=re(s.tiles_wide),t=re(s.tiles_tall),l=[];for(let n=0;n<t;n++)for(let i=0;i<e;i++)Nt(e,t,i,n)||Zt(0,1,s.random)<Vs||l.push(xt(s,i,n));return l},Bs=s=>{const e=re(s.state),t={tiles:e.tiles,items:[]},l=re(s.tiles_wide),n=re(s.tiles_tall),{items:i}=t;for(const o of e.items){const a=o.age+1,r=!o.dead&&a>o.dead_age?!0:o.dead;if(r&&a>o.dust_age)continue;const c={...o,age:a,dead:r};if(i.push(c),!(e.items.length<=e.tiles.length)||!(!o.dead&&o.age>=o.reproduction_age)||!(Zt(0,1,s.random)<o.reproduction*re(s.reproduction)))continue;const R=ut(Wt,s.random),m=ut(Wt,s.random),C=c.x+R,A=c.y+m;if(!Nt(l,n,C,A)&&As(l,n,C,A)&&!qt(e.items,C,A)&&!qt(i,C,A)){const P=xt(s,C,A,{char:c.char,age:0});i.push(P)}}return t},qt=(s,e,t)=>{for(const l of s)if(l.x===e&&l.y===t)return l},xt=(s,e,t,l)=>{const n=(l==null?void 0:l.age)??It(0,10,s.random),i=5,o=5,a=10;return{id:Ps(),x:e,y:t,dead:n>=a,dead_age:a,dust_age:a+o,reproduction:1,reproduction_age:i,...l,age:n,char:(l==null?void 0:l.char)??ut(s.trees,s.random)}},Xt=(...s)=>{let e=0,t=0,l=0,n=1;const i=s.length?s:[Date.now()];let o=Hs();e=o(" "),t=o(" "),l=o(" ");for(const r of i)e-=o(r),e<0&&(e+=1),t-=o(r),t<0&&(t+=1),l-=o(r),l<0&&(l+=1);o=null;const a=()=>{const r=2091639*e+n*23283064365386963e-26;return e=t,t=l,l=r-(n=r|0)};return a.uint32=()=>a()*4294967296,a.fract53=()=>a()+(a()*2097152|0)*11102230246251565e-32,a.version="Alea 0.9",a.seeds=i,a},Hs=()=>{let s=4022871197;return e=>{const t=e+"";for(let l=0;l<t.length;l++){s+=t.charCodeAt(l);let n=.02519603282416938*s;s=n>>>0,n-=s,n*=s,s=n>>>0,n-=s,s+=n*4294967296}return(s>>>0)*23283064365386963e-26}};class Rs{constructor(e,t,l=10,n=10){G(this,"seed",ke(1));G(this,"random",Xt(re(this.seed)));G(this,"tiles_wide");G(this,"tiles_tall");G(this,"state");G(this,"turn",ke(0));G(this,"reproduction",ke(.5));G(this,"wetness",3);G(this,"land_by_wetness",["🟧","🟨","🟫","🟩","🟦"]);G(this,"ocean",[...("🔵".repeat(4)+"🌊").repeat(8)+"🏝"]);G(this,"mountains",["⛰","🏔","🌋","🗻","🏞"]);G(this,"trees",["🌲","🌳"]);this.create_habitat_state=e,this.simulate_habitat=t,this.tiles_wide=ke(l),this.tiles_tall=ke(n),this.state=ke(this.create_habitat_state(this))}resize(e,t){this.tiles_wide.set(e),this.tiles_tall.set(t),this.reset()}setSeed(e){this.seed.set(e),this.reset()}reset(){this.random=Xt(re(this.seed)),this.state.set(this.create_habitat_state(this)),this.turn.set(0)}simulate(){this.state.set(this.simulate_habitat(this)),this.turn.update(e=>e+1)}}function Gt(s,e,t){const l=s.slice();return l[5]=e[t],l}function Jt(s,e){let t,l=e[5]+"",n,i,o,a;function r(){return e[4](e[5])}return{key:s,first:null,c(){t=p("button"),n=S(l),i=I(),this.h()},l(u){t=g(u,"BUTTON",{type:!0,class:!0});var c=T(t);n=B(c,l),i=N(c),c.forEach(v),this.h()},h(){f(t,"type","button"),f(t,"class","svelte-ey1io"),ze(t,"selected",e[2].includes(e[5])),this.first=t},m(u,c){K(u,t,c),_(t,n),_(t,i),o||(a=L(t,"click",r),o=!0)},p(u,c){e=u,c&1&&l!==(l=e[5]+"")&&_t(n,l),c&5&&ze(t,"selected",e[2].includes(e[5]))},d(u){u&&v(t),o=!1,a()}}}function Ws(s){let e,t=[],l=new Map,n=Oe(s[0]);const i=o=>o[5];for(let o=0;o<n.length;o+=1){let a=Gt(s,n,o),r=i(a);l.set(r,t[o]=Jt(r,a))}return{c(){e=p("fieldset");for(let o=0;o<t.length;o+=1)t[o].c();this.h()},l(o){e=g(o,"FIELDSET",{class:!0});var a=T(e);for(let r=0;r<t.length;r+=1)t[r].l(a);a.forEach(v),this.h()},h(){f(e,"class","svelte-ey1io")},m(o,a){K(o,e,a);for(let r=0;r<t.length;r+=1)t[r]&&t[r].m(e,null)},p(o,[a]){a&13&&(n=Oe(o[0]),t=Tt(t,a,i,1,o,n,l,e,ps,Jt,null,Gt))},i:J,o:J,d(o){o&&v(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function qs(s,e,t){let l,n=J,i=()=>(n(),n=rs(a,c=>t(2,l=c)),a);s.$$.on_destroy.push(()=>n());let{emojis:o}=e,{selected_emojis:a}=e;i();const r=c=>{Qt(a,l=l.includes(c)?l.filter(d=>d!==c):l.concat(c),l)},u=c=>r(c);return s.$$set=c=>{"emojis"in c&&t(0,o=c.emojis),"selected_emojis"in c&&i(t(1,a=c.selected_emojis))},[o,a,l,r,u]}class Xs extends Te{constructor(e){super(),Ie(this,e,qs,Ws,Ee,{emojis:0,selected_emojis:1})}}function Kt(s){let e,t;return e=new js({props:{state:s[16],tiles_wide:s[3],tiles_tall:s[4],display_width:s[13],display_height:s[12],show_tiles:s[7],show_items:s[8]}}),{c(){Ae(e.$$.fragment)},l(l){Pe(e.$$.fragment,l)},m(l,n){Ve(e,l,n),t=!0},p(l,n){const i={};n[0]&65536&&(i.state=l[16]),n[0]&8&&(i.tiles_wide=l[3]),n[0]&16&&(i.tiles_tall=l[4]),n[0]&8192&&(i.display_width=l[13]),n[0]&4096&&(i.display_height=l[12]),n[0]&128&&(i.show_tiles=l[7]),n[0]&256&&(i.show_items=l[8]),e.$set(i)},i(l){t||(z(e.$$.fragment,l),t=!0)},o(l){H(e.$$.fragment,l),t=!1},d(l){Fe(e,l)}}}function Gs(s){let e;return{c(){e=S("play")},l(t){e=B(t,"play")},m(t,l){K(t,e,l)},d(t){t&&v(e)}}}function Js(s){let e;return{c(){e=S("pause")},l(t){e=B(t,"pause")},m(t,l){K(t,e,l)},d(t){t&&v(e)}}}function Ks(s){let e,t,l,n,i,o,a,r,u,c,d,w,U,R,m,C="tick",A,P,Ne="reset",F,te,Q,pe,W,Se,O,Ue,Y,se="randomize",De,Z,Me,V,x,q,Be,le,He,X,Re,ie,We,ne,qe,$,Xe,ae,b,y,ue,ee,ct,_e,ft,he,ge,we,ht,dt,ve,be,mt,pt,de,me,Ut="about",gt,ce,Ce,Dt="source code",wt,ye,Mt="🌵",ts=`${$e}px`,Ct,st,oe,vt,j,bt,jt;Vt(s[35]);let D=s[13]>0&&Kt(s);o=new Xs({props:{emojis:s[18],selected_emojis:s[19]}});function Lt(h,k){return h[10]?Js:Gs}let lt=Lt(s),fe=lt(s);function ss(h){s[41](h)}let zt={};return s[9]!==void 0&&(zt.post_message=s[9]),oe=new ks({props:zt}),us.push(()=>hs(oe,"post_message",ss)),oe.$on("message",s[42]),{c(){e=p("div"),t=p("div"),D&&D.c(),l=I(),n=p("div"),i=p("form"),Ae(o.$$.fragment),a=I(),r=p("div"),u=S("turn "),c=S(s[17]),d=I(),w=p("fieldset"),U=p("button"),fe.c(),R=I(),m=p("button"),m.textContent=C,A=I(),P=p("button"),P.textContent=Ne,F=I(),te=p("fieldset"),Q=p("label"),pe=S(`seed
					`),W=p("input"),Se=I(),O=p("input"),Ue=I(),Y=p("button"),Y.textContent=se,De=I(),Z=p("label"),Me=S(`turn duration
				`),V=p("input"),x=I(),q=p("input"),Be=I(),le=p("label"),He=S(`reproduction rate
				`),X=p("input"),Re=I(),ie=p("input"),We=I(),ne=p("label"),qe=S(`tiles wide
				`),$=p("input"),Xe=I(),ae=p("input"),b=I(),y=p("label"),ue=S(`tiles tall
				`),ee=p("input"),ct=I(),_e=p("input"),ft=I(),he=p("fieldset"),ge=p("label"),we=p("input"),ht=S(`
					show tiles`),dt=I(),ve=p("label"),be=p("input"),mt=S(`
					show items`),pt=I(),de=p("footer"),me=p("a"),me.textContent=Ut,gt=I(),ce=p("a"),Ce=p("div"),Ce.textContent=Dt,wt=I(),ye=p("div"),ye.textContent=Mt,st=I(),Ae(oe.$$.fragment),this.h()},l(h){e=g(h,"DIV",{class:!0});var k=T(e);t=g(k,"DIV",{class:!0,style:!0});var Ge=T(t);D&&D.l(Ge),Ge.forEach(v),l=N(k),n=g(k,"DIV",{class:!0});var At=T(n);i=g(At,"FORM",{});var M=T(i);Pe(o.$$.fragment,M),a=N(M),r=g(M,"DIV",{class:!0});var yt=T(r);u=B(yt,"turn "),c=B(yt,s[17]),yt.forEach(v),d=N(M),w=g(M,"FIELDSET",{class:!0});var je=T(w);U=g(je,"BUTTON",{type:!0,class:!0});var Pt=T(U);fe.l(Pt),Pt.forEach(v),R=N(je),m=g(je,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),Le(m)!=="svelte-1kws75n"&&(m.textContent=C),A=N(je),P=g(je,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),Le(P)!=="svelte-1yi2hpt"&&(P.textContent=Ne),je.forEach(v),F=N(M),te=g(M,"FIELDSET",{class:!0});var it=T(te);Q=g(it,"LABEL",{class:!0});var Je=T(Q);pe=B(Je,`seed
					`),W=g(Je,"INPUT",{type:!0,step:!0,min:!0,max:!0}),Se=N(Je),O=g(Je,"INPUT",{type:!0,class:!0}),Je.forEach(v),Ue=N(it),Y=g(it,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),Le(Y)!=="svelte-13z5mpb"&&(Y.textContent=se),it.forEach(v),De=N(M),Z=g(M,"LABEL",{class:!0});var Ke=T(Z);Me=B(Ke,`turn duration
				`),V=g(Ke,"INPUT",{type:!0,step:!0,min:!0,max:!0}),x=N(Ke),q=g(Ke,"INPUT",{type:!0,class:!0}),Ke.forEach(v),Be=N(M),le=g(M,"LABEL",{class:!0});var Qe=T(le);He=B(Qe,`reproduction rate
				`),X=g(Qe,"INPUT",{type:!0,step:!0,min:!0,max:!0}),Re=N(Qe),ie=g(Qe,"INPUT",{type:!0,class:!0}),Qe.forEach(v),We=N(M),ne=g(M,"LABEL",{class:!0});var Ye=T(ne);qe=B(Ye,`tiles wide
				`),$=g(Ye,"INPUT",{type:!0,step:!0,min:!0,max:!0}),Xe=N(Ye),ae=g(Ye,"INPUT",{type:!0,class:!0}),Ye.forEach(v),b=N(M),y=g(M,"LABEL",{class:!0});var Ze=T(y);ue=B(Ze,`tiles tall
				`),ee=g(Ze,"INPUT",{type:!0,step:!0,min:!0,max:!0}),ct=N(Ze),_e=g(Ze,"INPUT",{type:!0,class:!0}),Ze.forEach(v),ft=N(M),he=g(M,"FIELDSET",{class:!0});var nt=T(he);ge=g(nt,"LABEL",{class:!0});var kt=T(ge);we=g(kt,"INPUT",{type:!0}),ht=B(kt,`
					show tiles`),kt.forEach(v),dt=N(nt),ve=g(nt,"LABEL",{class:!0});var Et=T(ve);be=g(Et,"INPUT",{type:!0}),mt=B(Et,`
					show items`),Et.forEach(v),nt.forEach(v),pt=N(M),de=g(M,"FOOTER",{class:!0});var at=T(de);me=g(at,"A",{class:!0,href:!0,"data-svelte-h":!0}),Le(me)!=="svelte-1kzpil1"&&(me.textContent=Ut),gt=N(at),ce=g(at,"A",{href:!0,class:!0});var ot=T(ce);Ce=g(ot,"DIV",{"data-svelte-h":!0}),Le(Ce)!=="svelte-4deh8w"&&(Ce.textContent=Dt),wt=N(ot),ye=g(ot,"DIV",{"data-svelte-h":!0}),Le(ye)!=="svelte-18w2oa3"&&(ye.textContent=Mt),ot.forEach(v),at.forEach(v),M.forEach(v),At.forEach(v),k.forEach(v),st=N(h),Pe(oe.$$.fragment,h),this.h()},h(){f(t,"class","world svelte-wfv9mu"),E(t,"--animation_duration",s[11]+"ms"),f(r,"class","turn svelte-wfv9mu"),f(U,"type","button"),f(U,"class","svelte-wfv9mu"),E(U,"flex","1"),f(m,"type","button"),f(m,"class","svelte-wfv9mu"),f(P,"type","button"),f(P,"class","svelte-wfv9mu"),f(w,"class","row svelte-wfv9mu"),f(W,"type","range"),W.value=s[14],f(W,"step",1),f(W,"min",$t),f(W,"max",es),f(O,"type","text"),O.value=s[14],f(O,"class","svelte-wfv9mu"),f(Q,"class","seed-label svelte-wfv9mu"),f(Y,"type","button"),f(Y,"class","svelte-wfv9mu"),f(te,"class","svelte-wfv9mu"),f(V,"type","range"),V.value=s[5],f(V,"step",1e3/60),f(V,"min",s[24]),f(V,"max",$s),f(q,"type","number"),q.value=s[5],f(q,"class","svelte-wfv9mu"),f(Z,"class","svelte-wfv9mu"),f(X,"type","range"),X.value=s[15],f(X,"step",.01),f(X,"min",0),f(X,"max",1),f(ie,"type","number"),ie.value=s[15],f(ie,"class","svelte-wfv9mu"),f(le,"class","svelte-wfv9mu"),f($,"type","range"),$.value=s[3],f($,"step",1),f($,"min",Qs),f($,"max",Ys),f(ae,"type","number"),ae.value=s[3],f(ae,"class","svelte-wfv9mu"),f(ne,"class","svelte-wfv9mu"),f(ee,"type","range"),ee.value=s[4],f(ee,"step",1),f(ee,"min",Zs),f(ee,"max",xs),f(_e,"type","number"),_e.value=s[4],f(_e,"class","svelte-wfv9mu"),f(y,"class","svelte-wfv9mu"),f(we,"type","checkbox"),we.checked=s[7],f(ge,"class","svelte-wfv9mu"),f(be,"type","checkbox"),be.checked=s[8],f(ve,"class","svelte-wfv9mu"),f(he,"class","row svelte-wfv9mu"),f(me,"class","chip"),f(me,"href",ds+"/about"),E(ye,"font-size","var(--icon_size_md)"),f(ce,"href","https://github.com/feltjs/felt_habitat"),f(ce,"class","box"),f(de,"class","box svelte-wfv9mu"),E(i,"max-width",ts),f(n,"class","controls svelte-wfv9mu"),E(n,"width",s[6]?"100%":$e+"px"),E(n,"height",s[6]?s[12]+"px":"100%"),f(e,"class","universe svelte-wfv9mu"),Vt(()=>s[40].call(e)),ze(e,"vertical",s[6])},m(h,k){K(h,e,k),_(e,t),D&&D.m(t,null),_(e,l),_(e,n),_(n,i),Ve(o,i,null),_(i,a),_(i,r),_(r,u),_(r,c),_(i,d),_(i,w),_(w,U),fe.m(U,null),_(w,R),_(w,m),_(w,A),_(w,P),_(i,F),_(i,te),_(te,Q),_(Q,pe),_(Q,W),_(Q,Se),_(Q,O),_(te,Ue),_(te,Y),_(i,De),_(i,Z),_(Z,Me),_(Z,V),_(Z,x),_(Z,q),_(i,Be),_(i,le),_(le,He),_(le,X),_(le,Re),_(le,ie),_(i,We),_(i,ne),_(ne,qe),_(ne,$),_(ne,Xe),_(ne,ae),_(i,b),_(i,y),_(y,ue),_(y,ee),_(y,ct),_(y,_e),_(i,ft),_(i,he),_(he,ge),_(ge,we),_(ge,ht),_(he,dt),_(he,ve),_(ve,be),_(ve,mt),_(i,pt),_(i,de),_(de,me),_(de,gt),_(de,ce),_(ce,Ce),_(ce,wt),_(ce,ye),Ct=_s(e,s[40].bind(e)),K(h,st,k),Ve(oe,h,k),j=!0,bt||(jt=[L(window,"resize",s[35]),L(U,"click",s[36]),L(m,"click",s[37]),L(P,"click",s[38]),L(W,"input",s[29]("seed")),L(O,"input",s[28]("seed")),L(Y,"click",s[39]),L(V,"input",s[29]("turn_duration")),L(q,"input",s[29]("turn_duration")),L(X,"input",s[29]("reproduction_rate")),L(ie,"input",s[29]("reproduction_rate")),L($,"input",s[29]("tiles_wide")),L(ae,"input",s[29]("tiles_wide")),L(ee,"input",s[29]("tiles_tall")),L(_e,"input",s[29]("tiles_tall")),L(we,"input",s[30]("show_tiles")),L(be,"input",s[30]("show_items"))],bt=!0)},p(h,k){h[13]>0?D?(D.p(h,k),k[0]&8192&&z(D,1)):(D=Kt(h),D.c(),z(D,1),D.m(t,null)):D&&(et(),H(D,1,1,()=>{D=null}),tt()),(!j||k[0]&2048)&&E(t,"--animation_duration",h[11]+"ms"),(!j||k[0]&131072)&&_t(c,h[17]),lt!==(lt=Lt(h))&&(fe.d(1),fe=lt(h),fe&&(fe.c(),fe.m(U,null))),(!j||k[0]&16384)&&(W.value=h[14]),(!j||k[0]&16384&&O.value!==h[14])&&(O.value=h[14]),(!j||k[0]&32)&&(V.value=h[5]),(!j||k[0]&32&&q.value!==h[5])&&(q.value=h[5]),(!j||k[0]&32768)&&(X.value=h[15]),(!j||k[0]&32768&&ie.value!==h[15])&&(ie.value=h[15]),(!j||k[0]&8)&&($.value=h[3]),(!j||k[0]&8&&ae.value!==h[3])&&(ae.value=h[3]),(!j||k[0]&16)&&(ee.value=h[4]),(!j||k[0]&16&&_e.value!==h[4])&&(_e.value=h[4]),(!j||k[0]&128)&&(we.checked=h[7]),(!j||k[0]&256)&&(be.checked=h[8]),k[0]&64&&E(n,"width",h[6]?"100%":$e+"px"),k[0]&4160&&E(n,"height",h[6]?h[12]+"px":"100%"),(!j||k[0]&64)&&ze(e,"vertical",h[6]);const Ge={};!vt&&k[0]&512&&(vt=!0,Ge.post_message=h[9],cs(()=>vt=!1)),oe.$set(Ge)},i(h){j||(z(D),z(o.$$.fragment,h),z(oe.$$.fragment,h),j=!0)},o(h){H(D),H(o.$$.fragment,h),H(oe.$$.fragment,h),j=!1},d(h){h&&(v(e),v(st)),D&&D.d(),Fe(o),fe.d(),Ct(),Fe(oe,h),bt=!1,fs(jt)}}}const $e=300,Qs=3,Ys=33,Zs=3,xs=33,$t=0,es=9999,$s=2e3;function el(s,e,t){let l,n,i,o,a,r,u,c,d,w;const U=["🌲","🌳","🌴","🌵"],R=ke(U.slice(0,2));xe(s,R,b=>t(34,c=b));let m=0,C=0,A=0,P=13,Ne=10;const F=new Rs(Fs,Bs),{turn:te,state:Q,reproduction:pe,seed:W}=F;xe(s,te,b=>t(17,w=b)),xe(s,Q,b=>t(16,d=b)),xe(s,pe,b=>t(15,u=b)),xe(s,W,b=>t(14,r=b));const Se=1e3/30;let O=1e3,Ue=!0,Y=!0,se=null;const De=()=>{x(se?{type:"habitat.stop"}:{type:"habitat.start"})},Z=()=>{se===null&&t(33,se=setInterval(()=>{F.simulate()},O))},Me=()=>{se!==null&&(clearInterval(se),t(33,se=null))};let V;const x=b=>{V({type:"Ephemera",params:b}),q(b)},q=b=>{switch(console.log("updateHabitat message",b),b.type){case"habitat.start":{Z();break}case"habitat.stop":{Me();break}case"habitat.reset":{F.reset();break}case"habitat.next_turn":{F.simulate();break}case"habitat.update_state":{const{value:y}=b;y.tiles_wide!==void 0&&t(3,P=y.tiles_wide),y.tiles_tall!==void 0&&t(4,Ne=y.tiles_tall),y.show_tiles!==void 0&&t(7,Ue=y.show_tiles),y.show_items!==void 0&&t(8,Y=y.show_items),y.turn_duration!==void 0&&t(5,O=y.turn_duration),y.reproduction_rate!==void 0&&Qt(pe,u=y.reproduction_rate,u),y.seed!==void 0&&F.setSeed(y.seed);break}default:throw new gs(b)}},Be=b=>y=>{const ue=/^[\d\.]+$/u.test(y.target.value)?parseFloat(y.target.value):y.target.value,ee=Number.isNaN(ue)?y.target.value:ue;x({type:"habitat.update_state",value:{[b]:ee}})},le=b=>y=>{x({type:"habitat.update_state",value:{[b]:Number(y.target.value)}})},He=b=>y=>{x({type:"habitat.update_state",value:{[b]:y.target.checked}})},X=()=>{let b;do b=It($t,es,F.random);while(b===r);return b};function Re(){t(0,m=window.innerWidth)}const ie=()=>De(),We=()=>x({type:"habitat.next_turn"}),ne=()=>x({type:"habitat.reset"}),qe=()=>x({type:"habitat.update_state",value:{seed:X()}});function $(){C=this.clientWidth,A=this.clientHeight,t(1,C),t(2,A)}function Xe(b){V=b,t(9,V)}const ae=b=>{var ue;console.log("message from window host e",b.detail),((ue=b.detail)==null?void 0:ue.data)&&q(b.detail.data)};return s.$$.update=()=>{s.$$.dirty[0]&1&&t(6,l=m<$e*2.5),s.$$.dirty[1]&8&&t(32,F.trees=c,F),s.$$.dirty[0]&24|s.$$.dirty[1]&2&&F.resize(P,Ne),s.$$.dirty[0]&66&&t(13,n=l?C:C-$e),s.$$.dirty[0]&68&&t(12,i=l?A/2:A),s.$$.dirty[0]&32&&t(11,o=Math.max(16.67,O*.95-16.67)),s.$$.dirty[0]&32&&(Me(),Z()),s.$$.dirty[1]&4&&t(10,a=se!==null)},[m,C,A,P,Ne,O,l,Ue,Y,V,a,o,i,n,r,u,d,w,U,R,te,Q,pe,W,Se,De,x,q,Be,le,He,X,F,se,c,Re,ie,We,ne,qe,$,Xe,ae]}class tl extends Te{constructor(e){super(),Ie(this,e,el,Ks,Ee,{},null,[-1,-1])}}function sl(s){let e,t;return e=new tl({}),{c(){Ae(e.$$.fragment)},l(l){Pe(e.$$.fragment,l)},m(l,n){Ve(e,l,n),t=!0},p:J,i(l){t||(z(e.$$.fragment,l),t=!0)},o(l){H(e.$$.fragment,l),t=!1},d(l){Fe(e,l)}}}class _l extends Te{constructor(e){super(),Ie(this,e,null,sl,Ee,{})}}export{_l as component};
