import{n as Ue,C as G,G as V,E as Ts,o as Cs,F as Ds,b as f,k as he,f as h,g as k,l as me,d as w,h as u,J as Oe,j as C,i as J,x as _,m as yt,s as E,c as I,e as wt,Q as _e,D as Ns,P as vs,R as $t,p as Us,L as te,S as Ms,U as Vs,K as Ls,O as et}from"../chunks/scheduler.um4-EiIM.js";import{S as Me,i as Ve,a as A,g as st,t as H,c as lt,b as Be,d as He,m as Re,e as We,f as js}from"../chunks/index.IJ9aZeYB.js";import{w as Ne}from"../chunks/index.bAv4hZ8b.js";import{b as zs}from"../chunks/paths.9Ayarp46.js";import{g as As}from"../chunks/globals.0cDDIVm6.js";import{e as qe,u as Ot,o as gs,d as Ps}from"../chunks/each.znMKjIFJ.js";class Fs extends Error{constructor(e,t=`Unreachable case: ${e}`){super(t)}}const ws=(s,e,t=Math.random)=>t()*(e-s)+s,Bt=(s,e,t=Math.random)=>Math.floor(t()*(e-s+1))+s,bt=(s,e=Math.random)=>s[Bt(0,s.length-1,e)],{window:Ss}=As;function Os(s){let e,t;return{c:G,l:G,m(l,n){e||(t=V(Ss,"message",s[0]),e=!0)},p:G,i:G,o:G,d(l){e=!1,t()}}}const Bs=6e3;function Hs(s,e,t){let{host:l=typeof window<"u"&&window.parent!==window?window.parent:null}=e,{target_origin:n="*"}=e,{connect_on_mount:i=!0}=e;const r=Ts(),a=v=>{l&&(l instanceof ServiceWorker||l instanceof MessagePort?l.postMessage(v):l.postMessage(v,n))};Cs(async()=>{i&&await D()}),Ds(()=>{b&&clearTimeout(b)});let o="initial",c,d,p,b;const D=async()=>l?c&&d===l?c:(d=l,c=new Promise(v=>{p=v,o="pending",a({type:"felt.connect"}),b=setTimeout(()=>{o="failure",c=void 0,b=void 0,p(!1),p=void 0},Bs)})):!1,R=v=>{if(v.source!==l)return;const U=v.data;if(U){if(U.type==="felt.connected"){if(o!=="pending")return;o="success",clearTimeout(b),b=void 0,p(!0),p=void 0}U.type&&o==="success"&&r("message",U)}};return s.$$set=v=>{"host"in v&&t(1,l=v.host),"target_origin"in v&&t(2,n=v.target_origin),"connect_on_mount"in v&&t(3,i=v.connect_on_mount)},[R,l,n,i,a,D]}class Rs extends Me{constructor(e){super(),Ve(this,e,Hs,Os,Ue,{host:1,target_origin:2,connect_on_mount:3,post_message:4,connect:5})}get post_message(){return this.$$.ctx[4]}get connect(){return this.$$.ctx[5]}}function Ws(s){let e,t,l=s[0].char+"",n;return{c(){e=f("div"),t=f("div"),n=he(l),this.h()},l(i){e=h(i,"DIV",{class:!0,style:!0});var r=k(e);t=h(r,"DIV",{class:!0});var a=k(t);n=me(a,l),a.forEach(w),r.forEach(w),this.h()},h(){u(t,"class","svelte-10gyibm"),Oe(t,"dead",s[0].dead),u(e,"class","item svelte-10gyibm"),C(e,"transform","translate3d("+s[3]+"px, "+s[2]+"px, 0px) scale3d("+s[5]+", "+s[5]+", "+s[5]+")"),C(e,"--grayscale",s[4]),C(e,"opacity",1-s[1])},m(i,r){J(i,e,r),_(e,t),_(t,n)},p(i,[r]){r&1&&l!==(l=i[0].char+"")&&yt(n,l),r&1&&Oe(t,"dead",i[0].dead),r&44&&C(e,"transform","translate3d("+i[3]+"px, "+i[2]+"px, 0px) scale3d("+i[5]+", "+i[5]+", "+i[5]+")"),r&16&&C(e,"--grayscale",i[4]),r&2&&C(e,"opacity",1-i[1])},i:G,o:G,d(i){i&&w(e)}}}function qs(s,e,t){let l,n,i,r,a,{item:o}=e,{tile_width:c}=e,{tile_height:d}=e;return s.$$set=p=>{"item"in p&&t(0,o=p.item),"tile_width"in p&&t(6,c=p.tile_width),"tile_height"in p&&t(7,d=p.tile_height)},s.$$.update=()=>{s.$$.dirty&1&&t(1,l=o.dead?(o.age-o.dead_age)/(o.dust_age-o.dead_age):0),s.$$.dirty&3&&t(5,n=Math.min(1,o.age/o.dead_age)*Math.sqrt(1-l/4)),s.$$.dirty&3&&t(4,i=o.dead?l*100/2+"%":"0%"),s.$$.dirty&65&&t(3,r=o.x*c),s.$$.dirty&129&&t(2,a=o.y*d)},[o,l,a,r,i,n,c,d]}class Xs extends Me{constructor(e){super(),Ve(this,e,qs,Ws,Ue,{item:0,tile_width:6,tile_height:7})}}function Gs(s){let e,t=s[0].char+"",l;return{c(){e=f("div"),l=he(t),this.h()},l(n){e=h(n,"DIV",{class:!0,style:!0});var i=k(e);l=me(i,t),i.forEach(w),this.h()},h(){u(e,"class","tile svelte-icdim1"),C(e,"transform","translate3d("+s[0].x*s[1]+"px, "+s[0].y*s[2]+"px, 0px)")},m(n,i){J(n,e,i),_(e,l)},p(n,[i]){i&1&&t!==(t=n[0].char+"")&&yt(l,t),i&7&&C(e,"transform","translate3d("+n[0].x*n[1]+"px, "+n[0].y*n[2]+"px, 0px)")},i:G,o:G,d(n){n&&w(e)}}}function Js(s,e,t){let{tile:l}=e,{tile_width:n}=e,{tile_height:i}=e;return s.$$set=r=>{"tile"in r&&t(0,l=r.tile),"tile_width"in r&&t(1,n=r.tile_width),"tile_height"in r&&t(2,i=r.tile_height)},[l,n,i]}class Ks extends Me{constructor(e){super(),Ve(this,e,Js,Gs,Ue,{tile:0,tile_width:1,tile_height:2})}}function es(s,e,t){const l=s.slice();return l[12]=e[t],l}function ts(s,e,t){const l=s.slice();return l[15]=e[t],l}function ss(s){let e,t=[],l=new Map,n,i=qe(s[0].tiles);const r=a=>a[15].id;for(let a=0;a<i.length;a+=1){let o=ts(s,i,a),c=r(o);l.set(c,t[a]=ls(c,o))}return{c(){e=f("div");for(let a=0;a<t.length;a+=1)t[a].c();this.h()},l(a){e=h(a,"DIV",{class:!0});var o=k(e);for(let c=0;c<t.length;c+=1)t[c].l(o);o.forEach(w),this.h()},h(){u(e,"class","tiles svelte-pux4ee")},m(a,o){J(a,e,o);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,null);n=!0},p(a,o){o&9&&(i=qe(a[0].tiles),st(),t=Ot(t,o,r,1,a,i,l,e,gs,ls,null,ts),lt())},i(a){if(!n){for(let o=0;o<i.length;o+=1)A(t[o]);n=!0}},o(a){for(let o=0;o<t.length;o+=1)H(t[o]);n=!1},d(a){a&&w(e);for(let o=0;o<t.length;o+=1)t[o].d()}}}function ls(s,e){let t,l,n;return l=new Ks({props:{tile:e[15],tile_width:e[3],tile_height:e[3]}}),{key:s,first:null,c(){t=wt(),Be(l.$$.fragment),this.h()},l(i){t=wt(),He(l.$$.fragment,i),this.h()},h(){this.first=t},m(i,r){J(i,t,r),Re(l,i,r),n=!0},p(i,r){e=i;const a={};r&1&&(a.tile=e[15]),r&8&&(a.tile_width=e[3]),r&8&&(a.tile_height=e[3]),l.$set(a)},i(i){n||(A(l.$$.fragment,i),n=!0)},o(i){H(l.$$.fragment,i),n=!1},d(i){i&&w(t),We(l,i)}}}function is(s){let e,t=[],l=new Map,n,i=qe(s[0].items);const r=a=>a[12].id;for(let a=0;a<i.length;a+=1){let o=es(s,i,a),c=r(o);l.set(c,t[a]=ns(c,o))}return{c(){e=f("div");for(let a=0;a<t.length;a+=1)t[a].c();this.h()},l(a){e=h(a,"DIV",{class:!0});var o=k(e);for(let c=0;c<t.length;c+=1)t[c].l(o);o.forEach(w),this.h()},h(){u(e,"class","items svelte-pux4ee")},m(a,o){J(a,e,o);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,null);n=!0},p(a,o){o&9&&(i=qe(a[0].items),st(),t=Ot(t,o,r,1,a,i,l,e,gs,ns,null,es),lt())},i(a){if(!n){for(let o=0;o<i.length;o+=1)A(t[o]);n=!0}},o(a){for(let o=0;o<t.length;o+=1)H(t[o]);n=!1},d(a){a&&w(e);for(let o=0;o<t.length;o+=1)t[o].d()}}}function ns(s,e){let t,l,n;return l=new Xs({props:{item:e[12],tile_width:e[3],tile_height:e[3]}}),{key:s,first:null,c(){t=wt(),Be(l.$$.fragment),this.h()},l(i){t=wt(),He(l.$$.fragment,i),this.h()},h(){this.first=t},m(i,r){J(i,t,r),Re(l,i,r),n=!0},p(i,r){e=i;const a={};r&1&&(a.item=e[12]),r&8&&(a.tile_width=e[3]),r&8&&(a.tile_height=e[3]),l.$set(a)},i(i){n||(A(l.$$.fragment,i),n=!0)},o(i){H(l.$$.fragment,i),n=!1},d(i){i&&w(t),We(l,i)}}}function Qs(s){let e,t,l=`${s[3]}px`,n=`${s[5]}px`,i=`${s[4]}px`,r=`${s[3]}px`,a=`${s[3]}px`,o,c=s[1]&&ss(s),d=s[2]&&is(s);return{c(){e=f("div"),c&&c.c(),t=E(),d&&d.c(),this.h()},l(p){e=h(p,"DIV",{class:!0});var b=k(e);c&&c.l(b),t=I(b),d&&d.l(b),b.forEach(w),this.h()},h(){u(e,"class","habitat svelte-pux4ee"),C(e,"--tile_size",l),C(e,"--habitat_width",n),C(e,"--habitat_height",i),C(e,"--tile_height",r),C(e,"--tile_width",a)},m(p,b){J(p,e,b),c&&c.m(e,null),_(e,t),d&&d.m(e,null),o=!0},p(p,[b]){p[1]?c?(c.p(p,b),b&2&&A(c,1)):(c=ss(p),c.c(),A(c,1),c.m(e,t)):c&&(st(),H(c,1,1,()=>{c=null}),lt()),p[2]?d?(d.p(p,b),b&4&&A(d,1)):(d=is(p),d.c(),A(d,1),d.m(e,null)):d&&(st(),H(d,1,1,()=>{d=null}),lt()),b&8&&l!==(l=`${p[3]}px`)&&C(e,"--tile_size",l),b&32&&n!==(n=`${p[5]}px`)&&C(e,"--habitat_width",n),b&16&&i!==(i=`${p[4]}px`)&&C(e,"--habitat_height",i),b&8&&r!==(r=`${p[3]}px`)&&C(e,"--tile_height",r),b&8&&a!==(a=`${p[3]}px`)&&C(e,"--tile_width",a)},i(p){o||(A(c),A(d),o=!0)},o(p){H(c),H(d),o=!1},d(p){p&&w(e),c&&c.d(),d&&d.d()}}}function Ys(s,e,t){let l,n,i,r,a,{state:o}=e,{tiles_wide:c}=e,{tiles_tall:d}=e,{display_width:p}=e,{display_height:b}=e,{show_tiles:D=!0}=e,{show_items:R=!0}=e;return s.$$set=v=>{"state"in v&&t(0,o=v.state),"tiles_wide"in v&&t(6,c=v.tiles_wide),"tiles_tall"in v&&t(7,d=v.tiles_tall),"display_width"in v&&t(8,p=v.display_width),"display_height"in v&&t(9,b=v.display_height),"show_tiles"in v&&t(1,D=v.show_tiles),"show_items"in v&&t(2,R=v.show_items)},s.$$.update=()=>{s.$$.dirty&320&&t(11,l=Math.floor(p/c)),s.$$.dirty&640&&t(10,n=Math.floor(b/d)),s.$$.dirty&3072&&t(3,i=Math.min(l,n)),s.$$.dirty&72&&t(5,r=c*i),s.$$.dirty&136&&t(4,a=d*i)},[o,D,R,i,a,r,c,d,p,b,n,l]}class Zs extends Me{constructor(e){super(),Ve(this,e,Ys,Qs,Ue,{state:0,tiles_wide:6,tiles_tall:7,display_width:8,display_height:9,show_tiles:1,show_items:2})}}const xs=(s=0)=>{let e=s;return()=>e++},$s=(s,e,t="_")=>{const l=xs(e);return()=>`${s}${t}${l()}`},Ht=(s,e,t,l)=>t===0||t===s-1||l===0||l===e-1,el=(s,e,t,l)=>t>=0&&l>=0&&t<s&&l<e,as=[-1,0,1],tl=$s("item"),sl=.8,ll=s=>({tiles:il(s),items:nl(s)}),il=s=>{const e=_e(s.tiles_wide),t=_e(s.tiles_tall),l=[];let n=0;for(let i=0;i<t;i++)for(let r=0;r<e;r++){const a=n;n++;let o;Ht(e,t,r,i)?o=bt(s.ocean,s.random):o=s.land_by_wetness[s.wetness],l.push({id:`${r},${i}`,x:r,y:i,index:a,char:o})}return l},nl=s=>{const e=_e(s.tiles_wide),t=_e(s.tiles_tall),l=[];for(let n=0;n<t;n++)for(let i=0;i<e;i++)Ht(e,t,i,n)||ws(0,1,s.random)<sl||l.push(bs(s,i,n));return l},al=s=>{const e=_e(s.state),t={tiles:e.tiles,items:[]},l=_e(s.tiles_wide),n=_e(s.tiles_tall),{items:i}=t;for(const r of e.items){const a=r.age+1,o=!r.dead&&a>r.dead_age?!0:r.dead;if(o&&a>r.dust_age)continue;const d={...r,age:a,dead:o};if(i.push(d),!(e.items.length<=e.tiles.length)||!(!r.dead&&r.age>=r.reproduction_age)||!(ws(0,1,s.random)<r.reproduction*_e(s.reproduction)))continue;const R=bt(as,s.random),v=bt(as,s.random),U=d.x+R,P=d.y+v;if(!Ht(l,n,U,P)&&el(l,n,U,P)&&!rs(e.items,U,P)&&!rs(i,U,P)){const F=bs(s,U,P,{char:d.char,age:0});i.push(F)}}return t},rs=(s,e,t)=>{for(const l of s)if(l.x===e&&l.y===t)return l},bs=(s,e,t,l)=>{const n=l?.age??Bt(0,10,s.random),i=5,r=5,a=10;return{id:tl(),x:e,y:t,dead:n>=a,dead_age:a,dust_age:a+r,reproduction:1,reproduction_age:i,...l,age:n,char:l?.char??bt(s.trees,s.random)}},os=(...s)=>{let e=0,t=0,l=0,n=1;const i=s.length?s:[Date.now()];let r=rl();e=r(" "),t=r(" "),l=r(" ");for(const o of i)e-=r(o),e<0&&(e+=1),t-=r(o),t<0&&(t+=1),l-=r(o),l<0&&(l+=1);r=null;const a=()=>{const o=2091639*e+n*23283064365386963e-26;return e=t,t=l,l=o-(n=o|0)};return a.uint32=()=>a()*4294967296,a.fract53=()=>a()+(a()*2097152|0)*11102230246251565e-32,a.version="Alea 0.9",a.seeds=i,a},rl=()=>{let s=4022871197;return e=>{const t=e+"";for(let l=0;l<t.length;l++){s+=t.charCodeAt(l);let n=.02519603282416938*s;s=n>>>0,n-=s,n*=s,s=n>>>0,n-=s,s+=n*4294967296}return(s>>>0)*23283064365386963e-26}};class ol{constructor(e,t,l=10,n=10){this.create_habitat_state=e,this.simulate_habitat=t,this.tiles_wide=Ne(l),this.tiles_tall=Ne(n),this.state=Ne(this.create_habitat_state(this))}seed=Ne(1);random=os(_e(this.seed));tiles_wide;tiles_tall;state;turn=Ne(0);reproduction=Ne(.5);wetness=3;land_by_wetness=["🟧","🟨","🟫","🟩","🟦"];ocean=[...("🔵".repeat(4)+"🌊").repeat(8)+"🏝"];mountains=["⛰","🏔","🌋","🗻","🏞"];trees=["🌲","🌳"];resize(e,t){this.tiles_wide.set(e),this.tiles_tall.set(t),this.reset()}setSeed(e){this.seed.set(e),this.reset()}reset(){this.random=os(_e(this.seed)),this.state.set(this.create_habitat_state(this)),this.turn.set(0)}simulate(){this.state.set(this.simulate_habitat(this)),this.turn.update(e=>e+1)}}function us(s,e,t){const l=s.slice();return l[5]=e[t],l}function _s(s,e){let t,l=e[5]+"",n,i,r,a;function o(){return e[4](e[5])}return{key:s,first:null,c(){t=f("button"),n=he(l),i=E(),this.h()},l(c){t=h(c,"BUTTON",{type:!0,class:!0});var d=k(t);n=me(d,l),i=I(d),d.forEach(w),this.h()},h(){u(t,"type","button"),u(t,"class","svelte-ey1io"),Oe(t,"selected",e[2].includes(e[5])),this.first=t},m(c,d){J(c,t,d),_(t,n),_(t,i),r||(a=V(t,"click",o),r=!0)},p(c,d){e=c,d&1&&l!==(l=e[5]+"")&&yt(n,l),d&5&&Oe(t,"selected",e[2].includes(e[5]))},d(c){c&&w(t),r=!1,a()}}}function ul(s){let e,t=[],l=new Map,n=qe(s[0]);const i=r=>r[5];for(let r=0;r<n.length;r+=1){let a=us(s,n,r),o=i(a);l.set(o,t[r]=_s(o,a))}return{c(){e=f("fieldset");for(let r=0;r<t.length;r+=1)t[r].c();this.h()},l(r){e=h(r,"FIELDSET",{class:!0});var a=k(e);for(let o=0;o<t.length;o+=1)t[o].l(a);a.forEach(w),this.h()},h(){u(e,"class","svelte-ey1io")},m(r,a){J(r,e,a);for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(e,null)},p(r,[a]){a&13&&(n=qe(r[0]),t=Ot(t,a,i,1,r,n,l,e,Ps,_s,null,us))},i:G,o:G,d(r){r&&w(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function _l(s,e,t){let l,n=G,i=()=>(n(),n=Ns(a,d=>t(2,l=d)),a);s.$$.on_destroy.push(()=>n());let{emojis:r}=e,{selected_emojis:a}=e;i();const o=d=>{vs(a,l=l.includes(d)?l.filter(p=>p!==d):l.concat(d),l)},c=d=>o(d);return s.$$set=d=>{"emojis"in d&&t(0,r=d.emojis),"selected_emojis"in d&&i(t(1,a=d.selected_emojis))},[r,a,l,o,c]}class cl extends Me{constructor(e){super(),Ve(this,e,_l,ul,Ue,{emojis:0,selected_emojis:1})}}function cs(s){let e,t;return e=new Zs({props:{state:s[16],tiles_wide:s[3],tiles_tall:s[4],display_width:s[13],display_height:s[12],show_tiles:s[7],show_items:s[8]}}),{c(){Be(e.$$.fragment)},l(l){He(e.$$.fragment,l)},m(l,n){Re(e,l,n),t=!0},p(l,n){const i={};n[0]&65536&&(i.state=l[16]),n[0]&8&&(i.tiles_wide=l[3]),n[0]&16&&(i.tiles_tall=l[4]),n[0]&8192&&(i.display_width=l[13]),n[0]&4096&&(i.display_height=l[12]),n[0]&128&&(i.show_tiles=l[7]),n[0]&256&&(i.show_items=l[8]),e.$set(i)},i(l){t||(A(e.$$.fragment,l),t=!0)},o(l){H(e.$$.fragment,l),t=!1},d(l){We(e,l)}}}function dl(s){let e;return{c(){e=he("play")},l(t){e=me(t,"play")},m(t,l){J(t,e,l)},d(t){t&&w(e)}}}function fl(s){let e;return{c(){e=he("pause")},l(t){e=me(t,"pause")},m(t,l){J(t,e,l)},d(t){t&&w(e)}}}function hl(s){let e,t,l,n,i,r,a,o,c,d,p,b,D,R,v,U="tick",P,F,Le="reset",O,Z,x,$,Xe="seed",Ge,W,q,je,L,ze,K,Je="randomize",pe,z,ee,it="turn duration",Ke,se,X,Qe,B,Ye,le,ce,nt="reproduction rate",Ze,ie,g,T,S,xe,ve,ne,ye,Rt="tiles wide",kt,ae,Et,Q,It,re,ke,Wt="tiles tall",Tt,oe,Ct,Y,Dt,ge,Ee,Ie,Nt,Ut,Te,Ce,Mt,Vt,we,be,qt="about",Lt,de,Ae,Xt="source code",jt,De,Gt="🌵",Es=`${tt}px`,Jt,at,ue,zt,M,At,Kt;$t(s[35]);let N=s[13]>0&&cs(s);r=new cl({props:{emojis:s[18],selected_emojis:s[19]}});function Qt(m,y){return m[10]?fl:dl}let rt=Qt(s),fe=rt(s);function Is(m){s[41](m)}let Yt={};return s[9]!==void 0&&(Yt.post_message=s[9]),ue=new Rs({props:Yt}),Us.push(()=>js(ue,"post_message",Is)),ue.$on("message",s[42]),{c(){e=f("div"),t=f("div"),N&&N.c(),l=E(),n=f("div"),i=f("form"),Be(r.$$.fragment),a=E(),o=f("div"),c=he("turn "),d=he(s[17]),p=E(),b=f("fieldset"),D=f("button"),fe.c(),R=E(),v=f("button"),v.textContent=U,P=E(),F=f("button"),F.textContent=Le,O=E(),Z=f("fieldset"),x=f("label"),$=f("div"),$.textContent=Xe,Ge=E(),W=f("div"),q=f("input"),je=E(),L=f("input"),ze=E(),K=f("button"),K.textContent=Je,pe=E(),z=f("label"),ee=f("div"),ee.textContent=it,Ke=E(),se=f("div"),X=f("input"),Qe=E(),B=f("input"),Ye=E(),le=f("label"),ce=f("div"),ce.textContent=nt,Ze=E(),ie=f("div"),g=f("input"),T=E(),S=f("input"),xe=E(),ve=f("fieldset"),ne=f("label"),ye=f("div"),ye.textContent=Rt,kt=E(),ae=f("input"),Et=E(),Q=f("input"),It=E(),re=f("label"),ke=f("div"),ke.textContent=Wt,Tt=E(),oe=f("input"),Ct=E(),Y=f("input"),Dt=E(),ge=f("fieldset"),Ee=f("label"),Ie=f("input"),Nt=he(`
					show tiles`),Ut=E(),Te=f("label"),Ce=f("input"),Mt=he(`
					show items`),Vt=E(),we=f("footer"),be=f("a"),be.textContent=qt,Lt=E(),de=f("a"),Ae=f("div"),Ae.textContent=Xt,jt=E(),De=f("div"),De.textContent=Gt,at=E(),Be(ue.$$.fragment),this.h()},l(m){e=h(m,"DIV",{class:!0});var y=k(e);t=h(y,"DIV",{class:!0,style:!0});var $e=k(t);N&&N.l($e),$e.forEach(w),l=I(y),n=h(y,"DIV",{class:!0});var Zt=k(n);i=h(Zt,"FORM",{});var j=k(i);He(r.$$.fragment,j),a=I(j),o=h(j,"DIV",{class:!0});var Pt=k(o);c=me(Pt,"turn "),d=me(Pt,s[17]),Pt.forEach(w),p=I(j),b=h(j,"FIELDSET",{class:!0});var Pe=k(b);D=h(Pe,"BUTTON",{type:!0,class:!0});var xt=k(D);fe.l(xt),xt.forEach(w),R=I(Pe),v=h(Pe,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),te(v)!=="svelte-1kws75n"&&(v.textContent=U),P=I(Pe),F=h(Pe,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),te(F)!=="svelte-1yi2hpt"&&(F.textContent=Le),Pe.forEach(w),O=I(j),Z=h(j,"FIELDSET",{class:!0});var ot=k(Z);x=h(ot,"LABEL",{class:!0});var ut=k(x);$=h(ut,"DIV",{class:!0,"data-svelte-h":!0}),te($)!=="svelte-1hqynec"&&($.textContent=Xe),Ge=I(ut),W=h(ut,"DIV",{class:!0});var _t=k(W);q=h(_t,"INPUT",{type:!0,step:!0,min:!0,max:!0}),je=I(_t),L=h(_t,"INPUT",{type:!0,class:!0}),_t.forEach(w),ut.forEach(w),ze=I(ot),K=h(ot,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),te(K)!=="svelte-13z5mpb"&&(K.textContent=Je),ot.forEach(w),pe=I(j),z=h(j,"LABEL",{class:!0});var ct=k(z);ee=h(ct,"DIV",{class:!0,"data-svelte-h":!0}),te(ee)!=="svelte-9er5cg"&&(ee.textContent=it),Ke=I(ct),se=h(ct,"DIV",{class:!0});var dt=k(se);X=h(dt,"INPUT",{type:!0,step:!0,min:!0,max:!0}),Qe=I(dt),B=h(dt,"INPUT",{type:!0,step:!0,min:!0,max:!0,class:!0}),dt.forEach(w),ct.forEach(w),Ye=I(j),le=h(j,"LABEL",{class:!0});var ft=k(le);ce=h(ft,"DIV",{class:!0,"data-svelte-h":!0}),te(ce)!=="svelte-5m3xox"&&(ce.textContent=nt),Ze=I(ft),ie=h(ft,"DIV",{class:!0});var ht=k(ie);g=h(ht,"INPUT",{type:!0,step:!0,min:!0,max:!0}),T=I(ht),S=h(ht,"INPUT",{type:!0,step:!0,min:!0,max:!0,class:!0}),ht.forEach(w),ft.forEach(w),xe=I(j),ve=h(j,"FIELDSET",{class:!0});var mt=k(ve);ne=h(mt,"LABEL",{class:!0});var Fe=k(ne);ye=h(Fe,"DIV",{class:!0,"data-svelte-h":!0}),te(ye)!=="svelte-vocpq7"&&(ye.textContent=Rt),kt=I(Fe),ae=h(Fe,"INPUT",{type:!0,step:!0,min:!0,max:!0}),Et=I(Fe),Q=h(Fe,"INPUT",{type:!0,step:!0,min:!0,max:!0,class:!0}),Fe.forEach(w),It=I(mt),re=h(mt,"LABEL",{class:!0});var Se=k(re);ke=h(Se,"DIV",{class:!0,"data-svelte-h":!0}),te(ke)!=="svelte-cra6hn"&&(ke.textContent=Wt),Tt=I(Se),oe=h(Se,"INPUT",{type:!0,step:!0,min:!0,max:!0}),Ct=I(Se),Y=h(Se,"INPUT",{type:!0,step:!0,min:!0,max:!0,class:!0}),Se.forEach(w),mt.forEach(w),Dt=I(j),ge=h(j,"FIELDSET",{class:!0});var pt=k(ge);Ee=h(pt,"LABEL",{class:!0});var Ft=k(Ee);Ie=h(Ft,"INPUT",{type:!0}),Nt=me(Ft,`
					show tiles`),Ft.forEach(w),Ut=I(pt),Te=h(pt,"LABEL",{class:!0});var St=k(Te);Ce=h(St,"INPUT",{type:!0}),Mt=me(St,`
					show items`),St.forEach(w),pt.forEach(w),Vt=I(j),we=h(j,"FOOTER",{class:!0});var vt=k(we);be=h(vt,"A",{class:!0,href:!0,"data-svelte-h":!0}),te(be)!=="svelte-1kzpil1"&&(be.textContent=qt),Lt=I(vt),de=h(vt,"A",{href:!0,class:!0});var gt=k(de);Ae=h(gt,"DIV",{"data-svelte-h":!0}),te(Ae)!=="svelte-4deh8w"&&(Ae.textContent=Xt),jt=I(gt),De=h(gt,"DIV",{"data-svelte-h":!0}),te(De)!=="svelte-18w2oa3"&&(De.textContent=Gt),gt.forEach(w),vt.forEach(w),j.forEach(w),Zt.forEach(w),y.forEach(w),at=I(m),He(ue.$$.fragment,m),this.h()},h(){u(t,"class","world svelte-wfv9mu"),C(t,"--animation_duration",s[11]+"ms"),u(o,"class","turn svelte-wfv9mu"),u(D,"type","button"),u(D,"class","svelte-wfv9mu"),C(D,"flex","1"),u(v,"type","button"),u(v,"class","svelte-wfv9mu"),u(F,"type","button"),u(F,"class","svelte-wfv9mu"),u(b,"class","row svelte-wfv9mu"),u($,"class","title"),u(q,"type","range"),q.value=s[14],u(q,"step",1),u(q,"min",ys),u(q,"max",ks),u(L,"type","text"),L.value=s[14],u(L,"class","svelte-wfv9mu"),u(W,"class","row"),u(x,"class","seed-label svelte-wfv9mu"),u(K,"type","button"),u(K,"class","svelte-wfv9mu"),u(Z,"class","svelte-wfv9mu"),u(ee,"class","title"),u(X,"type","range"),X.value=s[5],u(X,"step",1e3/60),u(X,"min",s[24]),u(X,"max",ps),u(B,"type","number"),B.value=s[5],u(B,"step",1e3/60),u(B,"min",s[24]),u(B,"max",ps),u(B,"class","svelte-wfv9mu"),u(se,"class","row"),u(z,"class","svelte-wfv9mu"),u(ce,"class","title"),u(g,"type","range"),g.value=s[15],u(g,"step",.01),u(g,"min",0),u(g,"max",1),u(S,"type","number"),S.value=s[15],u(S,"step",.01),u(S,"min",0),u(S,"max",1),u(S,"class","svelte-wfv9mu"),u(ie,"class","row"),u(le,"class","svelte-wfv9mu"),u(ye,"class","title"),u(ae,"type","range"),ae.value=s[3],u(ae,"step",1),u(ae,"min",ds),u(ae,"max",fs),u(Q,"type","number"),Q.value=s[3],u(Q,"step",1),u(Q,"min",ds),u(Q,"max",fs),u(Q,"class","svelte-wfv9mu"),u(ne,"class","svelte-wfv9mu"),u(ke,"class","title"),u(oe,"type","range"),oe.value=s[4],u(oe,"step",1),u(oe,"min",hs),u(oe,"max",ms),u(Y,"type","number"),Y.value=s[4],u(Y,"step",1),u(Y,"min",hs),u(Y,"max",ms),u(Y,"class","svelte-wfv9mu"),u(re,"class","svelte-wfv9mu"),u(ve,"class","row svelte-wfv9mu"),u(Ie,"type","checkbox"),Ie.checked=s[7],u(Ee,"class","svelte-wfv9mu"),u(Ce,"type","checkbox"),Ce.checked=s[8],u(Te,"class","svelte-wfv9mu"),u(ge,"class","row svelte-wfv9mu"),u(be,"class","chip"),u(be,"href",zs+"/about"),C(De,"font-size","var(--icon_size_md)"),u(de,"href","https://github.com/feltjs/felt_habitat"),u(de,"class","box"),u(we,"class","box svelte-wfv9mu"),C(i,"max-width",Es),u(n,"class","controls svelte-wfv9mu"),C(n,"width",s[6]?"100%":tt+"px"),C(n,"height",s[6]?s[12]+"px":"100%"),u(e,"class","universe svelte-wfv9mu"),$t(()=>s[40].call(e)),Oe(e,"vertical",s[6])},m(m,y){J(m,e,y),_(e,t),N&&N.m(t,null),_(e,l),_(e,n),_(n,i),Re(r,i,null),_(i,a),_(i,o),_(o,c),_(o,d),_(i,p),_(i,b),_(b,D),fe.m(D,null),_(b,R),_(b,v),_(b,P),_(b,F),_(i,O),_(i,Z),_(Z,x),_(x,$),_(x,Ge),_(x,W),_(W,q),_(W,je),_(W,L),_(Z,ze),_(Z,K),_(i,pe),_(i,z),_(z,ee),_(z,Ke),_(z,se),_(se,X),_(se,Qe),_(se,B),_(i,Ye),_(i,le),_(le,ce),_(le,Ze),_(le,ie),_(ie,g),_(ie,T),_(ie,S),_(i,xe),_(i,ve),_(ve,ne),_(ne,ye),_(ne,kt),_(ne,ae),_(ne,Et),_(ne,Q),_(ve,It),_(ve,re),_(re,ke),_(re,Tt),_(re,oe),_(re,Ct),_(re,Y),_(i,Dt),_(i,ge),_(ge,Ee),_(Ee,Ie),_(Ee,Nt),_(ge,Ut),_(ge,Te),_(Te,Ce),_(Te,Mt),_(i,Vt),_(i,we),_(we,be),_(we,Lt),_(we,de),_(de,Ae),_(de,jt),_(de,De),Jt=Ms(e,s[40].bind(e)),J(m,at,y),Re(ue,m,y),M=!0,At||(Kt=[V(window,"resize",s[35]),V(D,"click",s[36]),V(v,"click",s[37]),V(F,"click",s[38]),V(q,"input",s[29]("seed")),V(L,"input",s[28]("seed")),V(K,"click",s[39]),V(X,"input",s[29]("turn_duration")),V(B,"input",s[29]("turn_duration")),V(g,"input",s[29]("reproduction_rate")),V(S,"input",s[29]("reproduction_rate")),V(ae,"input",s[29]("tiles_wide")),V(Q,"input",s[29]("tiles_wide")),V(oe,"input",s[29]("tiles_tall")),V(Y,"input",s[29]("tiles_tall")),V(Ie,"input",s[30]("show_tiles")),V(Ce,"input",s[30]("show_items"))],At=!0)},p(m,y){m[13]>0?N?(N.p(m,y),y[0]&8192&&A(N,1)):(N=cs(m),N.c(),A(N,1),N.m(t,null)):N&&(st(),H(N,1,1,()=>{N=null}),lt()),(!M||y[0]&2048)&&C(t,"--animation_duration",m[11]+"ms"),(!M||y[0]&131072)&&yt(d,m[17]),rt!==(rt=Qt(m))&&(fe.d(1),fe=rt(m),fe&&(fe.c(),fe.m(D,null))),(!M||y[0]&16384)&&(q.value=m[14]),(!M||y[0]&16384&&L.value!==m[14])&&(L.value=m[14]),(!M||y[0]&32)&&(X.value=m[5]),(!M||y[0]&32&&B.value!==m[5])&&(B.value=m[5]),(!M||y[0]&32768)&&(g.value=m[15]),(!M||y[0]&32768&&S.value!==m[15])&&(S.value=m[15]),(!M||y[0]&8)&&(ae.value=m[3]),(!M||y[0]&8&&Q.value!==m[3])&&(Q.value=m[3]),(!M||y[0]&16)&&(oe.value=m[4]),(!M||y[0]&16&&Y.value!==m[4])&&(Y.value=m[4]),(!M||y[0]&128)&&(Ie.checked=m[7]),(!M||y[0]&256)&&(Ce.checked=m[8]),y[0]&64&&C(n,"width",m[6]?"100%":tt+"px"),y[0]&4160&&C(n,"height",m[6]?m[12]+"px":"100%"),(!M||y[0]&64)&&Oe(e,"vertical",m[6]);const $e={};!zt&&y[0]&512&&(zt=!0,$e.post_message=m[9],Vs(()=>zt=!1)),ue.$set($e)},i(m){M||(A(N),A(r.$$.fragment,m),A(ue.$$.fragment,m),M=!0)},o(m){H(N),H(r.$$.fragment,m),H(ue.$$.fragment,m),M=!1},d(m){m&&(w(e),w(at)),N&&N.d(),We(r),fe.d(),Jt(),We(ue,m),At=!1,Ls(Kt)}}}const tt=300,ds=3,fs=33,hs=3,ms=33,ys=0,ks=9999,ps=2e3;function ml(s,e,t){let l,n,i,r,a,o,c,d,p,b;const D=["🌲","🌳","🌴","🌵"],R=Ne(D.slice(0,2));et(s,R,g=>t(34,d=g));let v=0,U=0,P=0,F=13,Le=10;const O=new ol(ll,al),{turn:Z,state:x,reproduction:$,seed:Xe}=O;et(s,Z,g=>t(17,b=g)),et(s,x,g=>t(16,p=g)),et(s,$,g=>t(15,c=g)),et(s,Xe,g=>t(14,o=g));const Ge=1e3/30;let W=1e3,q=!0,je=!0,L=null;const ze=()=>{z(L?{type:"habitat.stop"}:{type:"habitat.start"})},K=()=>{L===null&&t(33,L=setInterval(()=>{O.simulate()},W))},Je=()=>{L!==null&&(clearInterval(L),t(33,L=null))};let pe;const z=g=>{pe({type:"Ephemera",params:g}),ee(g)},ee=g=>{switch(console.log("updateHabitat message",g),g.type){case"habitat.start":{K();break}case"habitat.stop":{Je();break}case"habitat.reset":{O.reset();break}case"habitat.next_turn":{O.simulate();break}case"habitat.update_state":{const{value:T}=g;T.tiles_wide!==void 0&&t(3,F=T.tiles_wide),T.tiles_tall!==void 0&&t(4,Le=T.tiles_tall),T.show_tiles!==void 0&&t(7,q=T.show_tiles),T.show_items!==void 0&&t(8,je=T.show_items),T.turn_duration!==void 0&&t(5,W=T.turn_duration),T.reproduction_rate!==void 0&&vs($,c=T.reproduction_rate,c),T.seed!==void 0&&O.setSeed(T.seed);break}default:throw new Fs(g)}},it=g=>T=>{const S=/^[\d\.]+$/u.test(T.target.value)?parseFloat(T.target.value):T.target.value,xe=Number.isNaN(S)?T.target.value:S;z({type:"habitat.update_state",value:{[g]:xe}})},Ke=g=>T=>{z({type:"habitat.update_state",value:{[g]:Number(T.target.value)}})},se=g=>T=>{z({type:"habitat.update_state",value:{[g]:T.target.checked}})},X=()=>{let g;do g=Bt(ys,ks,O.random);while(g===o);return g};function Qe(){t(0,v=window.innerWidth)}const B=()=>ze(),Ye=()=>z({type:"habitat.next_turn"}),le=()=>z({type:"habitat.reset"}),ce=()=>z({type:"habitat.update_state",value:{seed:X()}});function nt(){U=this.clientWidth,P=this.clientHeight,t(1,U),t(2,P)}function Ze(g){pe=g,t(9,pe)}const ie=g=>{console.log("message from window host e",g.detail),g.detail?.data&&ee(g.detail.data)};return s.$$.update=()=>{s.$$.dirty[0]&1&&t(6,l=v<tt*2.5),s.$$.dirty[1]&8&&t(32,O.trees=d,O),s.$$.dirty[0]&24|s.$$.dirty[1]&2&&O.resize(F,Le),s.$$.dirty[0]&66&&t(13,n=l?U:U-tt),s.$$.dirty[0]&68&&t(12,i=l?P/2:P),s.$$.dirty[0]&32&&t(11,r=Math.max(16.67,W*.95-16.67)),s.$$.dirty[0]&32&&(Je(),K()),s.$$.dirty[1]&4&&t(10,a=L!==null)},[v,U,P,F,Le,W,l,q,je,pe,a,r,i,n,o,c,p,b,D,R,Z,x,$,Xe,Ge,ze,z,ee,it,Ke,se,X,O,L,d,Qe,B,Ye,le,ce,nt,Ze,ie]}class pl extends Me{constructor(e){super(),Ve(this,e,ml,hl,Ue,{},null,[-1,-1])}}function vl(s){let e,t;return e=new pl({}),{c(){Be(e.$$.fragment)},l(l){He(e.$$.fragment,l)},m(l,n){Re(e,l,n),t=!0},p:G,i(l){t||(A(e.$$.fragment,l),t=!0)},o(l){H(e.$$.fragment,l),t=!1},d(l){We(e,l)}}}class Il extends Me{constructor(e){super(),Ve(this,e,null,vl,Ue,{})}}export{Il as component};
